/**
 * @author Lee Sylvester
 * @contributor Ed Rogers
 * @copyright Influxis
 **/(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=i.create({namespace:"controls.view",inherits:t.display.element,constructor:function(e,t){s.Super.constructor.call(this,e,t)},fields:{pointer:null},methods:{addChild:function(e){var n=t.display.element.getInstance(e);return this.addChildFromClass(n)},addChildFromClass:function(e){if(!e)return;this.$node().append(e.$node());this._children.push(e);e._parent=this.pointer;return e}}})})(jQuery,this);(function($){var types=$.fn.fluxui.types,fdata=$.fn.fluxui.fdata,assets=$.fn.fluxui.assets,$class=$.fn.fluxui.$class,clazz=$class.create({namespace:"controls.menu",inherits:types.display.element,constructor:function(e,t){clazz.Super.constructor.call(this,e,t)},methods:{initialise:function(){var m=this;$.post(types.core.securePath+"loggedIn",{},function(data){var d=eval(data);d.D==1&&m.showOptions()})},showOptions:function(){this.getChildById("login-menu").visible(!1);this.getChildById("app-menu").visible(!0)}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=t.events.dispatcher.getInstance(),o=i.create({namespace:"controls.dialog",inherits:t.display.element,constructor:function(e,t){o.Super.constructor.call(this,e,t)},fields:{alertMsg:"alert-message",importAsset:"import-asset",importComponent:"import-component",saveMovie:"save-movie",openMovie:"open-movie",registerUser:"register-user",embedMovie:"embed-movie",lblTxt:"asset-lbl-text",urlTxt:"asset-url-text",fileTxt:"asset-file-text",userTxt:"register-user-txt",passTxt:"register-pass-txt",emailTxt:"register-email-txt",registerMsg:"register-msg-lbl",embedTxt:"embed-text",filenameTxt:"file-name-text",fileOpenList:"file-open-list",progress:"asset-progress"},methods:{initialise:function(){t.controls.dialog._inst=this;s.addListeners({"dialog.submit":this.handleSubmit,"dialog.close":this.hide});this.$node().dialog({modal:!0});this.hide()},isOpen:function(){return t.controls.dialog.getInstance().$node().dialog("isOpen")},hide:function(){t.controls.dialog.getInstance().$node().dialog("close")},show:function(){t.controls.dialog.getInstance().$node().dialog("open")},height:function(e){t.controls.dialog.getInstance().$node().dialog("option","height",e)},width:function(e){t.controls.dialog.getInstance().$node().dialog("option","width",e)},title:function(e){t.controls.dialog.getInstance().$node().dialog("option","title",e)},contentContainer:function(){return this.getChildById("dialog-content")},setContent:function(e){var n,r,i=this;c=i.contentContainer().$node().children(),l=[i.lblTxt,i.urlTxt,i.userTxt,i.passTxt,i.emailTxt];i.contentContainer().getChildById(i.progress).display(!1);for(r=0;r<l.length;r++){n=i.getChildById(l[r]);!n||n.text("")}for(r=0;r<c.length;r++){var s=t.display.element.getInstance(c[r]);if(s.fluxid()==e){s.display(!0);i.height(s.height()+85);i.width(s.width()+20);i.title(s.attribute("text"));i.current=e}else s.display(!1)}},properUrl:function(e){e.indexOf("http")!=0&&(e="http://"+e);return e},handleSubmit:function(){var e,n=t.controls.dialog.getInstance();switch(n.current){case n.importAsset:e=n.getChildById(n.importAsset);var r=e.getChildById(n.lblTxt).text(),i=e.getChildById(n.urlTxt).text(),o=e.getChildById(n.fileTxt).$node(),u=e.getChildById(n.progress);if(!t.core.isURL(i)&&i!="")return n.showAlert("Please supply a valid path.");if(i==""&&o==null)return n.showAlert("Please supply an asset to upload or path to remote asset.");if(o[0].files&&o[0].files.length>0){u.display(!0);u.getChildById("duration").width(0);n.$node().fileupload({dataType:"text",url:"/upload",progressall:function(e,t){u.getChildById("duration").width(288*(t.loaded/t.total))}});n.$node().fileupload({formData:{label:r},done:function(e,o){console.log(o);var u=JSON.parse(o.result),a=t.core.serverPath;a=a.substr(0,a.length-1);i=n.properUrl(a+u.D[0].url);s._dispatch("dialog.confirm."+n.current,r,i)},error:function(e,t,r){n.showAlert("Could not upload asset. Are you logged in?");console.log(e,t,r)}}).fileupload("add",{files:o.get(0).files})}else{i=n.properUrl(i);s._dispatch("dialog.confirm."+n.current,r,i)}break;case n.importComponent:e=n.getChildById(n.importComponent);var r=e.getChildById(n.lblTxt).text(),i=e.getChildById(n.urlTxt).text();if(!t.core.isURL(i))return n.showAlert("Please supply a valid path.");i.indexOf("http")!=0&&(i="http://"+i);s._dispatch("dialog.confirm."+n.current,r,i);break;case n.saveMovie:e=n.getChildById(n.saveMovie);var a=e.getChildById(n.filenameTxt).text();if(a.length<3)return n.showAlert("The filename specified is less than the required 3 characters in length.");s._dispatch("dialog.confirm."+n.current,a);break;case n.openMovie:e=n.getChildById(n.openMovie);var a=e.getChildById(n.fileOpenList).value();if(a=="-")return n.showAlert("You must select a file to open before clicking 'Ok'");s._dispatch("dialog.confirm."+n.current,a);break;case n.registerUser:e=n.getChildById(n.registerUser);var f=e.getChildById(n.userTxt).text(),l=e.getChildById(n.passTxt).text(),c=e.getChildById(n.emailTxt).text();if(f.length<3)return n.showAlert("Username must be at least three characters");if(l.length<6)return n.showAlert("Password must be at least six characters");if(!t.controls.dialog.validEmail(c))return n.showAlert("Email must be valid");s._dispatch("dialog.confirm."+n.current,f,l,c);break;default:n.hide()}},showAlert:function(e){this.setContent(this.alertMsg);var t=this.getChildById(this.alertMsg);t.getChildById("message-text").text(e)}},statics:{getInstance:function(){return t.controls.dialog._inst},validEmail:function(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=t.events.dispatcher.getInstance(),o=i.create({namespace:"controls.properties",inherits:t.display.element,constructor:function(e,n){o.Super.constructor.call(this,e,n);t.controls.properties.getInstance(this)},fields:{propSheets:{},currentSheet:null},methods:{addChild:function(e){var n=t.display.element.getInstance(e);this.propSheets[n.ens]=n;o.Super.addChild.call(this,e);this.currentSheet||(this.currentSheet=n.ens);this.showSheet(this.currentSheet)},loadSheet:function(n,r){var i=this,s=t,o;e.getScript(n,function(){o=r.split(".");for(var e=0;e<o.length;e++){if(!s[o[e]]){console.log("Could not find prop sheet",r);return}s=s[o[e]]}s.create()})},showSheet:function(e){this.currentSheet=e;var t;for(var n in this.propSheets)if(this.propSheets.hasOwnProperty(n)){this.propSheets[n].display(n==this.currentSheet);if(n==this.currentSheet){!this.propSheets[n].update||this.propSheets[n].update();t=!0}}t||console.log("Could not find property sheet for element",e);return t}},statics:{getInstance:function(e){!e||(t.controls.properties._inst=e);return t.controls.properties._inst}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=t.events.dispatcher.getInstance(),o={type:"controls.crumb",initial:{props:{display:"inline",position:"relative",height:25,padding:2,"margin-right":5,"float":"left","border-color":"#999999","border-width":1}},behavior:{click:{event:"breadcrumbs.crumb.clicked"}},children:{keys:["label"],hash:{label:{type:"display.label",initial:{props:{display:"inline",position:"relative","font-family":"Arial","font-size":12,color:"#dddddd"}}}}}},u=i.create({namespace:"controls.breadcrumbs",inherits:t.display.element,constructor:function(e,t){u.Super.constructor.call(this,e,t)},methods:{initialise:function(e,t){var n=this;s.addListener("events.stage.level.change",function(e,t){n.setLevel(t)})},setLevel:function(e){this.emptyCrumbs();var t=e,n=[],r=null;if(e.fluxid()!="stage")for(;;){n.unshift(t);t=t.parent();if(!!r)break;t.fluxid()=="stage"&&(r=!0)}else n.push(e);this.addCrumbs(n)},addCrumbs:function(e){this.emptyCrumbs();if(!t.core.isArray(e)||e.length<1)return;for(var n=0;n<e.length;n++){var r="btn_"+n,i;t.serialiser.parse(r,o,this);i=this.getChildById(r);n>=e.length-1&&(i.current=!0);i.text(e[n].fluxid());i.ref=e[n]}},emptyCrumbs:function(){this.empty()}},statics:{getInstance:function(e){!e||(t.controls.breadcrumbs._inst=e);return t.controls.breadcrumbs._inst}}}),a=i.create({namespace:"controls.crumb",inherits:t.display.button,constructor:function(e,t){a.Super.constructor.call(this,e,t)},fields:{ref:null,current:!1},methods:{initialise:function(){this.label=this.getChildById("label")},text:function(e){return this.label.text(e)}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=t.events.dispatcher.getInstance(),o=i.create({namespace:"controls.statePanel",inherits:t.display.element,constructor:function(e,n){o.Super.constructor.call(this,e,n);t.controls.statePanel.inst=this},fields:{currentItem:null},methods:{initialise:function(e,t){this.duration=this.getChildById("state-duration");this.easing=this.getChildById("state-easing");this.stateName=this.getChildById("states-fld");this.list=this.getChildById("states-list");this.up=this.getChildById("up-state-btn");this.down=this.getChildById("down-state-btn");this.add=this.getChildById("add-state-btn");this.remove=this.getChildById("remove-state-btn");this.up.click(this,this.upClick);this.down.click(this,this.downClick);this.add.click(this,this.addClick);this.remove.click(this,this.removeClick);this.list.change(this,this.listChange);this.duration.change(this,this.durationChange);this.easing.change(this,this.easingChange);this.reset()},reset:function(){this.list.removeAll()},populate:function(e){this.reset();var t=e.frames.keys||[];(t.length==0||t.indexOf("initial")<0)&&t.unshift("initial");for(var n=0;n<t.length;n++)this.list.addItem(t[n]);this.currentItem=e;this.list.index(0);this.list.$node().trigger("change")},upClick:function(e){if(this.list.index()>1&&this.currentItem.editableFrames==1){var t=this.list.index(),n=t-1,r=this.list.moveItem(t,n);this.list.index(n);this.updateFrames()}},downClick:function(e){if(this.list.index()>0&&this.list.index()<this.list.length()-1&&this.currentItem.editableFrames==1){var t=this.list.index(),n=t+1,r=this.list.moveItem(t,n);this.list.index(n);this.updateFrames()}},addClick:function(e){var t=this.stateName.text();if(t!=""&&!this.list.contains(t)){this.list.addItem(t);this.stateName.text("");this.updateFrames()}},removeClick:function(e){if(this.list.index()>0){this.list.removeItem(this.list.text());this.updateFrames()}},listChange:function(){var e=this;this.currentItem.changeFrame(this.list.text(),function(){var n=e.frameData();if(n!=null){e.duration.text(n.duration);e.easing.value(n.easing)}t.controls.manipulator.getInstance().update();s.dispatch(this,"stage.element.change")})},durationChange:function(){var e=this.frameData(),t=parseInt(this.duration.text());e!=null&&!isNaN(t)&&(e.duration=t)},easingChange:function(){var e;if(e=this.frameData())e.easing=this.easing.value()},frameData:function(){var e=this.list.index(),t=this.currentItem.frames,n=t.keys,r;if(e>-1){r=t.hash[n[e]];if(!r||!r.duration||!r.easing)r=t.hash[n[e]]={duration:300,easing:"linearTween"};return r}return null},updateFrames:function(){var t=this.currentItem.frames,n=t.keys=[],r,i,s,o=this.list.$node().children();for(r=0;r<this.list.length();r++){i=e(o[r]),s=i.text();n.push(s);t.hash[s]||(t.hash[s]={})}for(r in t.hash)if(t.hash.hasOwnProperty(r)&&n.indexOf(r)==-1){delete i.hash[r];i.hash[r]=null}}},statics:{inst:null,getInstance:function(){return t.controls.statePanel.inst}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=t.events.dispatcher.getInstance(),o=e.fn.fluxui.$class.create({namespace:"properties.propsheet",inherits:t.display.element,constructor:function(e,t){o.Super.constructor.call(this,e,t)},methods:{initialise:function(n,r){var i=this;s.addListener("properties."+this.ens+".*",function(t,n){i.handlePropertyChange(e(n.target))});s.addListener("events."+this.ens+".changed",function(e,t){i.handleElementChange(e,t)});this.selection=t.selection.getInstance();this.manipulator=t.controls.manipulator.getInstance()},handleElementChange:function(e,t){t.entity()==this.ens&&this.updatePropertyFields(t,"events."+this.ens)},updatePropertyFields:function(e,n){var r=s;r.dispatch(this,n+".width.changed",e.width());r.dispatch(this,n+".height.changed",e.height());r.dispatch(this,n+".left.changed",parseInt(e.x()));r.dispatch(this,n+".top.changed",parseInt(e.y()));r.dispatch(this,n+".border-radius.changed",e.states.style("border-radius"));r.dispatch(this,n+".border-width.changed",parseInt(e.$node().css("border-left-width")));e.states.style("border-color")&&r.dispatch(this,n+".border-color.changed",t.core.clone(e.states.style("border-color")));r.dispatch(this,n+".id.changed",e.attribute("id"));r.dispatch(this,n+".class.changed",e.attribute("class"));r.dispatch(this,n+".text-align.changed",e.states.style("text-align"));r.dispatch(this,n+".text-decoration.changed",e.states.style("text-decoration"));r.dispatch(this,n+".font-family.changed",e.states.style("font-family"));r.dispatch(this,n+".font-size.changed",e.states.style("font-size"));r.dispatch(this,n+".font-weight.changed",e.states.style("font-weight"));e.states.style("fill")&&r.dispatch(this,n+".fill.changed",t.core.clone(e.states.style("fill")));e.states.style("color")&&r.dispatch(this,n+".color.changed",t.core.clone(e.states.style("color")));r.dispatch(this,n+".font-family.changed",e.states.style("font-family"));r.dispatch(this,n+".font-size.changed",parseInt(e.states.style("font-size")));r.dispatch(this,n+".flux-id.changed",e.fluxid());r.dispatch(this,"events.alignment.changed",e.states.getCurrentStateData().attr.center);!e.text||r.dispatch(this,n+".text.changed",e.text())},handlePropertyChange:function(e){if(this.selection._targets.length<1)return;var n=t.display.element.getInstance(this.selection.targets(0).get(0)),r=this.manipulator,i=parseInt(e.val()),s=e.val(),o=e.attr("fluxid");switch(o){case"flux-id":n.fluxid(s);break;case"left":case"top":case"width":case"height":r.style(o,i);case"font-family":case"font-size":case"border-width":case"border-radius":case"text-align":case"text-decoration":case"font-weight":n.style(o,s,1);break;case"color":case"border-color":n.style(o,t.controls.colorpicker.current().color,1);break;case"fill":var u=t.controls.colorpicker.current();t.core.isString(u.color)?n.style("fill",{type:"solid",colors:[{rgb:u.color,opacity:u.opacity}]},1):n.style("fill",t.core.clone(u.color),1);break;case"class":case"id":n.attribute(o,s,1);break;case"src":n.attribute(o,s);break;case"text":n.text(s,1);break;case"reset-asset":n.resetSize(function(e,t){n.width(r.width(e),1);n.height(r.height(t),1)});break;case"placeholder-asset":n.clearSrc();this.propPanel.getChildById("asset-source").index(0)}t.controls.manipulator.getInstance().update()}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=t.events.dispatcher.getInstance(),o={type:"properties.container",initial:{props:{fill:{type:"linear",direction:"top",colors:[{rgb:"#d6d6d6",opacity:1,pos:0},{rgb:"#d6d6d6",opacity:1,pos:.34},{rgb:"#000000",opacity:1,pos:.345},{rgb:"#d6d6d6",opacity:1,pos:.35},{rgb:"#d6d6d6",opacity:1,pos:.665},{rgb:"#000000",opacity:1,pos:.67},{rgb:"#d6d6d6",opacity:1,pos:.675}]},position:"relative",width:300,height:185}},children:{keys:["left","left-label","top","top-label","width","width-label","height","height-label","fill","fill-label","border-width","border-width-label","border-color","border-color-label","border-radius","border-radius-label","id","id-label","class","class-label","flux-id","flux-id-label"],hash:{left:{type:"display.form.textfield",initial:{props:{left:10,top:10,width:50}},bind:{text:{event:"events.display.container.left.changed"}},behavior:{change:{event:"properties.container.left"}}},"left-label":{type:"display.label",initial:{props:{left:70,top:10,width:20},attr:{text:"x"}}},top:{type:"display.form.textfield",initial:{props:{left:10,top:40,width:50}},bind:{text:{event:"events.display.container.top.changed"}},behavior:{change:{event:"properties.container.top"}}},"top-label":{type:"display.label",initial:{props:{left:70,top:40,width:20},attr:{text:"y"}}},width:{type:"display.form.textfield",initial:{props:{left:100,top:10,width:50}},bind:{text:{event:"events.display.container.width.changed"}},behavior:{change:{event:"properties.container.width"}}},"width-label":{type:"display.label",initial:{props:{left:160,top:10,width:20},attr:{text:"w"}}},height:{type:"display.form.textfield",initial:{props:{left:100,top:40,width:50}},bind:{text:{event:"events.display.container.height.changed"}},behavior:{change:{event:"properties.container.height"}}},"height-label":{type:"display.label",initial:{props:{left:160,top:40,width:20},attr:{text:"h"}}},fill:{type:"controls.colorpicker",initial:{props:{left:190,top:8},attr:{allowGradient:!0}},bind:{color:{event:"events.display.container.fill.changed"}},behavior:{change:{event:"properties.container.fill"},click:{event:"color.request"}}},"fill-label":{type:"display.label",initial:{props:{left:220,top:10},attr:{text:"bgcolor"}}},"border-color":{type:"controls.colorpicker",initial:{props:{left:190,top:68}},bind:{color:{event:"events.display.container.border-color.changed"}},behavior:{change:{event:"properties.container.border-color"},click:{event:"color.request"}}},"border-color-label":{type:"display.label",initial:{props:{left:220,top:70},attr:{text:"border color"}}},"border-width":{type:"display.form.textfield",initial:{props:{left:10,top:70,width:50}},bind:{text:{event:"events.display.container.border-width.changed"}},behavior:{change:{event:"properties.container.border-width"}}},"border-width-label":{type:"display.label",initial:{props:{left:70,top:70},attr:{text:"border weight"}}},"border-radius":{type:"display.form.textfield",initial:{props:{left:10,top:100,width:50}},bind:{text:{event:"events.display.container.border-radius.changed"}},behavior:{change:{event:"properties.container.border-radius"}}},"border-radius-label":{type:"display.label",initial:{props:{left:70,top:100},attr:{text:"border radius"}}},id:{type:"display.form.textfield",initial:{props:{left:10,top:130,width:80}},bind:{text:{event:"events.display.container.id.changed"}},behavior:{change:{event:"properties.container.id"}}},"id-label":{type:"display.label",initial:{props:{left:100,top:130,width:20},attr:{text:"id"}}},"class":{type:"display.form.textfield",initial:{props:{left:130,top:130,width:80}},bind:{text:{event:"events.display.container.class.changed"}},behavior:{change:{event:"properties.container.class"}}},"class-label":{type:"display.label",initial:{props:{left:220,top:130,width:40},attr:{text:"class"}}},"flux-id":{type:"display.form.textfield",initial:{props:{left:10,top:160,width:200}},bind:{text:{event:"events.display.container.flux-id.changed"}},behavior:{change:{event:"properties.container.flux-id"}}},"flux-id-label":{type:"display.label",initial:{props:{left:220,top:160,width:40},attr:{text:"flux id"}}}}}},u=e.fn.fluxui.$class.create({namespace:"properties.container",inherits:t.properties.propsheet,constructor:function(e,t){u.Super.constructor.call(this,e,t)},fields:{ens:"display.container"},methods:{initialise:function(t,n){var r=this;s.addListener("properties.container.*",function(t,n){r.handlePropertyChange(e(n.target))});u.Super.initialise.call(this,t,n)},update:function(){t.controls.colorpicker.current(this.getChildById("fill"))}},statics:{create:function(){var e="display.container";t.serialiser.parse(e+".props",o,t.controls.properties.getInstance())}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=t.events.dispatcher.getInstance(),o=t.display.element.getInstance,u={type:"properties.button",initial:{props:{fill:{type:"linear",direction:"top",colors:[{rgb:"#d6d6d6",opacity:1,pos:0},{rgb:"#d6d6d6",opacity:1,pos:.295},{rgb:"#000000",opacity:1,pos:.295},{rgb:"#d6d6d6",opacity:1,pos:.3},{rgb:"#d6d6d6",opacity:1,pos:.715},{rgb:"#000000",opacity:1,pos:.72},{rgb:"#d6d6d6",opacity:1,pos:.725}]},position:"relative",width:300,height:215}},children:{keys:["left","left-label","top","top-label","width","width-label","height","height-label","event-list","event-label","action-list","action-label","event-ctrls","id","id-label","class","class-label","flux-id","flux-id-label"],hash:{left:{type:"display.form.textfield",initial:{props:{left:10,top:10,width:50}},bind:{text:{event:"events.display.button.left.changed"}},behavior:{change:{event:"properties.button.left"}}},"left-label":{type:"display.label",initial:{props:{left:70,top:10,width:20},attr:{text:"x"}}},top:{type:"display.form.textfield",initial:{props:{left:10,top:40,width:50}},bind:{text:{event:"events.display.button.top.changed"}},behavior:{change:{event:"properties.button.top"}}},"top-label":{type:"display.label",initial:{props:{left:70,top:40,width:20},attr:{text:"y"}}},width:{type:"display.form.textfield",initial:{props:{left:100,top:10,width:50}},bind:{text:{event:"events.display.button.width.changed"}},behavior:{change:{event:"properties.button.width"}}},"width-label":{type:"display.label",initial:{props:{left:160,top:10,width:20},attr:{text:"w"}}},height:{type:"display.form.textfield",initial:{props:{left:100,top:40,width:50}},bind:{text:{event:"events.display.button.height.changed"}},behavior:{change:{event:"properties.button.height"}}},"height-label":{type:"display.label",initial:{props:{left:160,top:40,width:20},attr:{text:"h"}}},"event-list":{type:"display.form.dropdown",initial:{props:{left:10,top:70,width:55},attr:{labels:["click","over","out"],values:["click","mouseover","mouseout"]}}},"event-label":{type:"display.label",initial:{props:{left:70,top:70},attr:{text:"on"}}},"action-list":{type:"display.form.dropdown",initial:{props:{left:100,top:70,width:140},attr:{labels:["goto next frame","goto previous frame","goto frame label","goto url","mail to","dispatch event"],values:["gotoNextFrame","gotoPrevFrame","gotoFrame","gotoUrl","gotoEmail","dispatch"]}}},"action-label":{type:"display.label",initial:{props:{left:250,top:70},attr:{text:"action"}}},"event-ctrls":{type:"display.element",initial:{props:{top:90,left:0,width:300,height:65}},children:{keys:["ctrl-blank","ctrl-goto-label","ctrl-goto-url","ctrl-goto-email","ctrl-dispatch-event"],hash:{"ctrl-blank":{type:"display.element",initial:{}},"ctrl-goto-label":{type:"display.element",initial:{props:{width:300,height:65}},children:{keys:["frame-lbl-field","frame-lbl-label"],hash:{"frame-lbl-field":{type:"display.form.textfield",initial:{props:{top:10,left:10,width:200}}},"frame-lbl-label":{type:"display.label",initial:{props:{top:10,left:220},attr:{text:"frame label"}}}}}},"ctrl-goto-url":{type:"display.element",initial:{props:{width:300,height:65}},children:{keys:["url-field","url-label"],hash:{"url-field":{type:"display.form.textfield",initial:{props:{top:10,left:10,width:200}}},"url-label":{type:"display.label",initial:{props:{top:10,left:220},attr:{text:"url"}}}}}},"ctrl-goto-email":{type:"display.element",initial:{props:{width:300,height:65}},children:{keys:["email-field","email-label"],hash:{"email-field":{type:"display.form.textfield",initial:{props:{top:10,left:10,width:200}}},"email-label":{type:"display.label",initial:{props:{top:10,left:220},attr:{text:"email"}}}}}},"ctrl-dispatch-event":{type:"display.element",initial:{props:{width:300,height:65}},children:{keys:["event-field","event-label"],hash:{"event-field":{type:"display.form.textfield",initial:{props:{top:10,left:10,width:200}}},"event-label":{type:"display.label",initial:{props:{top:10,left:220},attr:{text:"event"}}}}}}}}},id:{type:"display.form.textfield",initial:{props:{left:10,top:160,width:80}},bind:{text:{event:"events.display.button.id.changed"}},behavior:{change:{event:"properties.button.id"}}},"id-label":{type:"display.label",initial:{props:{left:100,top:160,width:20},attr:{text:"id"}}},"class":{type:"display.form.textfield",initial:{props:{left:130,top:160,width:80}},bind:{text:{event:"events.display.button.class.changed"}},behavior:{change:{event:"properties.button.class"}}},"class-label":{type:"display.label",initial:{props:{left:220,top:160,width:40},attr:{text:"class"}}},"flux-id":{type:"display.form.textfield",initial:{props:{left:10,top:190,width:200}},bind:{text:{event:"events.display.button.flux-id.changed"}},behavior:{change:{event:"properties.button.flux-id"}}},"flux-id-label":{type:"display.label",initial:{props:{left:220,top:190,width:40},attr:{text:"flux id"}}}}}},a=e.fn.fluxui.$class.create({namespace:"properties.button",inherits:t.properties.propsheet,constructor:function(e,t){a.Super.constructor.call(this,e,t)},fields:{ens:"display.button"},methods:{initialise:function(t,n){a.Super.initialise.call(this,t,n);var r=this;s.addListener("properties.button.*",function(t,n){r.handlePropertyChange(e(n.target))});this.actionlist=this.getChildById("action-list");this.eventlist=this.getChildById("event-list");this.frameFld=this.getChildById("frame-lbl-field");this.urlFld=this.getChildById("url-field");this.emailFld=this.getChildById("email-field");this.eventFld=this.getChildById("event-field");this.actionlist.change(this,this.onAction);this.eventlist.change(this,this.onEvent);this.frameFld.change(this,this.frameChange);this.urlFld.change(this,this.urlChange);this.emailFld.change(this,this.emailChange);this.eventFld.change(this,this.eventChange);this.updateCtrls()},showCtrls:function(e){var t,n;switch(e){case"gotoFrame":t="ctrl-goto-label";break;case"gotoUrl":t="ctrl-goto-url";break;case"gotoEmail":t="ctrl-goto-email";break;case"dispatch":t="ctrl-dispatch-event";break;default:t="ctrl-blank"}var r=this.getChildById("event-ctrls").getChildren();for(n=0;n<r.length;n++)r[n].display(r[n].fluxid()==t)},createAction:function(e){var n=o(t.selection.getInstance().targets(0)).actions,r=this.eventlist.value(),i=n.behavior[r];if(!i){n.behavior[r]={};i=n.behavior[r]}i.action=this.actionlist.value();i.value=e;console.log(i,n.behavior)},onAction:function(){this.showCtrls(this.actionlist.value());this.actionlist.index()<2&&this.createAction()},onEvent:function(){this.updateCtrls()},frameChange:function(){this.createAction(this.frameFld.text())},urlChange:function(){this.createAction(this.urlFld.text())},emailChange:function(){this.createAction(this.emailFld.text())},eventChange:function(){this.createAction(this.eventFld.text())},updateCtrls:function(){var e=o(t.selection.getInstance().targets(0)),n=this.eventlist.value();if(!e)return;var r=e.actions.behavior[n];if(!!r&&!!r.action){this.actionlist.value(r.action);switch(r.action){case"gotoFrame":this.frameFld.text(r.value);break;case"gotoUrl":this.urlFld.text(r.value);break;case"gotoEmail":this.emailFld.text(r.value);break;case"dispatch":this.eventFld.text(r.value)}return}this.actionlist.index(0);this.actionlist.$node().trigger("change");this.showCtrls()},update:function(){this.updateCtrls()}},statics:{create:function(){var e="display.button";t.serialiser.parse(e+".props",u,t.controls.properties.getInstance())}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=t.events.dispatcher.getInstance(),o={type:"properties.image",initial:{props:{fill:{type:"linear",direction:"top",colors:[{rgb:"#d6d6d6",opacity:1,pos:0},{rgb:"#d6d6d6",opacity:1,pos:.295},{rgb:"#000000",opacity:1,pos:.295},{rgb:"#d6d6d6",opacity:1,pos:.3},{rgb:"#d6d6d6",opacity:1,pos:.715},{rgb:"#000000",opacity:1,pos:.72},{rgb:"#d6d6d6",opacity:1,pos:.725}]},position:"relative",width:300,height:215}},children:{keys:["left","left-label","top","top-label","width","width-label","height","height-label","reset-asset","reset-asset-label","border-width","border-width-label","border-color","border-color-label","border-radius","border-radius-label","src-label","src","placeholder-asset-label","placeholder-asset","id","id-label","class","class-label","flux-id","flux-id-label"],hash:{left:{type:"display.form.textfield",initial:{props:{left:10,top:10,width:50}},bind:{text:{event:"events.display.image.left.changed"}},behavior:{change:{event:"properties.image.left"}}},"left-label":{type:"display.label",initial:{props:{left:70,top:10,width:20},attr:{text:"x"}}},top:{type:"display.form.textfield",initial:{props:{left:10,top:40,width:50}},bind:{text:{event:"events.display.image.top.changed"}},behavior:{change:{event:"properties.image.top"}}},"top-label":{type:"display.label",initial:{props:{left:70,top:40,width:20},attr:{text:"y"}}},width:{type:"display.form.textfield",initial:{props:{left:100,top:10,width:50}},bind:{text:{event:"events.display.image.width.changed"}},behavior:{change:{event:"properties.image.width"}}},"width-label":{type:"display.label",initial:{props:{left:160,top:10,width:20},attr:{text:"w"}}},height:{type:"display.form.textfield",initial:{props:{left:100,top:40,width:50}},bind:{text:{event:"events.display.image.height.changed"}},behavior:{change:{event:"properties.image.height"}}},"height-label":{type:"display.label",initial:{props:{left:160,top:40,width:20},attr:{text:"h"}}},"placeholder-asset":{type:"display.image",initial:{props:{left:190,top:10,width:16,cursor:"pointer"},attr:{src:"btn-placeholder-asset"}},behavior:{click:{event:"properties.image.placeholder"}}},"placeholder-asset-label":{type:"display.label",initial:{props:{left:210,top:10,width:70},attr:{text:"placeholder"}}},"reset-asset":{type:"display.image",initial:{props:{left:190,top:40,width:16,cursor:"pointer"},attr:{src:"btn-reset-asset"}},behavior:{click:{event:"properties.image.reset-asset"}}},"reset-asset-label":{type:"display.label",initial:{props:{left:210,top:40,width:60},attr:{text:"reset size"}}},"border-color":{type:"controls.colorpicker",initial:{props:{left:185,top:68}},bind:{color:{event:"events.display.image.border-color.changed"}},behavior:{change:{event:"properties.image.border-color"},click:{event:"color.request"}}},"border-color-label":{type:"display.label",initial:{props:{left:210,top:70},attr:{text:"border color"}}},"border-width":{type:"display.form.textfield",initial:{props:{left:10,top:70,width:50}},bind:{text:{event:"events.display.image.border-width.changed"}},behavior:{change:{event:"properties.image.border-width"}}},"border-width-label":{type:"display.label",initial:{props:{left:70,top:70},attr:{text:"border weight"}}},"border-radius-label":{type:"display.label",initial:{props:{left:70,top:100},attr:{text:"border radius"}}},"border-radius":{type:"display.form.textfield",initial:{props:{left:10,top:100,width:50}},bind:{text:{event:"events.display.image.border-radius.changed"}},behavior:{change:{event:"properties.image.border-radius"}}},"src-label":{type:"display.label",initial:{props:{left:220,top:130,width:60},attr:{text:"source"}}},src:{type:"display.form.dropdown",initial:{props:{left:10,top:130,width:200}},bind:{text:{event:"events.display.image.src.changed"}},behavior:{change:{event:"properties.image.src"}}},id:{type:"display.form.textfield",initial:{props:{left:10,top:160,width:80}},bind:{text:{event:"events.display.image.id.changed"}},behavior:{change:{event:"properties.image.id"}}},"id-label":{type:"display.label",initial:{props:{left:100,top:160,width:20},attr:{text:"id"}}},"class":{type:"display.form.textfield",initial:{props:{left:130,top:160,width:80}},bind:{text:{event:"events.display.image.class.changed"}},behavior:{change:{event:"properties.image.class"}}},"class-label":{type:"display.label",initial:{props:{left:220,top:160,width:40},attr:{text:"class"}}},"flux-id":{type:"display.form.textfield",initial:{props:{left:10,top:190,width:200}},bind:{text:{event:"events.display.image.flux-id.changed"}},behavior:{change:{event:"properties.image.flux-id"}}},"flux-id-label":{type:"display.label",initial:{props:{left:220,top:190,width:40},attr:{text:"flux id"}}}}}},u=e.fn.fluxui.$class.create({namespace:"properties.image",inherits:t.properties.propsheet,constructor:function(e,t){u.Super.constructor.call(this,e,t)},fields:{ens:"display.image"},methods:{initialise:function(t,n){var r=this;s.addListener("properties.image.*",function(t,n){r.handlePropertyChange(e(n.target))});u.Super.initialise.call(this,t,n)},updatePropertyFields:function(e,t){var n=s,i=e.src(),o=!1;for(var a in r)if(r.hasOwnProperty(a)&&r[a].url==i){n.dispatch(this,t+".src.changed",a);o=!0;break}o==0&&n.dispatch(this,t+".src.changed","");u.Super.updatePropertyFields.call(this,e,t)},update:function(){t.controls.colorpicker.current
(this.getChildById("border-color"))}},statics:{create:function(){var e="display.image";t.serialiser.parse(e+".props",o,t.controls.properties.getInstance())}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=t.events.dispatcher.getInstance(),o={type:"properties.label",initial:{props:{fill:{type:"linear",direction:"top",colors:[{rgb:"#d6d6d6",opacity:1,pos:0},{rgb:"#d6d6d6",opacity:1,pos:.42},{rgb:"#000000",opacity:1,pos:.42},{rgb:"#d6d6d6",opacity:1,pos:.425}]},position:"relative",width:300,height:295}},children:{keys:["left","left-label","top","top-label","width","width-label","height","height-label","color","color-label","id","id-label","class","class-label","flux-id","flux-id-label","text","text-label","font-family","font-family-label","text-align","text-align-label","text-decoration","text-decoration-label","font-size","font-size-label","font-weight","font-weight-label"],hash:{left:{type:"display.form.textfield",initial:{props:{left:10,top:10,width:50}},bind:{text:{event:"events.display.label.left.changed"}},behavior:{change:{event:"properties.label.left"}}},"left-label":{type:"display.label",initial:{props:{left:70,top:10,width:20},attr:{text:"x"}}},top:{type:"display.form.textfield",initial:{props:{left:10,top:40,width:50}},bind:{text:{event:"events.display.label.top.changed"}},behavior:{change:{event:"properties.label.top"}}},"top-label":{type:"display.label",initial:{props:{left:70,top:40,width:20},attr:{text:"y"}}},width:{type:"display.form.textfield",initial:{props:{left:100,top:10,width:50}},bind:{text:{event:"events.display.label.width.changed"}},behavior:{change:{event:"properties.label.width"}}},"width-label":{type:"display.label",initial:{props:{left:160,top:10,width:20},attr:{text:"w"}}},height:{type:"display.form.textfield",initial:{props:{left:100,top:40,width:50}},bind:{text:{event:"events.display.label.height.changed"}},behavior:{change:{event:"properties.label.height"}}},"height-label":{type:"display.label",initial:{props:{left:160,top:40,width:20},attr:{text:"h"}}},color:{type:"controls.colorpicker",initial:{props:{left:190,top:8},attr:{allowGradient:!0}},bind:{color:{event:"events.display.label.color.changed"}},behavior:{change:{event:"properties.label.color"},click:{event:"color.request"}}},"color-label":{type:"display.label",initial:{props:{left:220,top:10},attr:{text:"color"}}},id:{type:"display.form.textfield",initial:{props:{left:10,top:70,width:80}},bind:{text:{event:"events.display.label.id.changed"}},behavior:{change:{event:"properties.label.id"}}},"id-label":{type:"display.label",initial:{props:{left:100,top:70,width:20},attr:{text:"id"}}},"class":{type:"display.form.textfield",initial:{props:{left:130,top:70,width:80}},bind:{text:{event:"events.display.label.class.changed"}},behavior:{change:{event:"properties.label.class"}}},"class-label":{type:"display.label",initial:{props:{left:220,top:70,width:40},attr:{text:"class"}}},"flux-id":{type:"display.form.textfield",initial:{props:{left:10,top:100,width:200}},bind:{text:{event:"events.display.label.flux-id.changed"}},behavior:{change:{event:"properties.label.flux-id"}}},"flux-id-label":{type:"display.label",initial:{props:{left:220,top:100,width:40},attr:{text:"flux id"}}},text:{type:"display.form.textarea",initial:{props:{left:10,top:130,width:200,height:55}},bind:{text:{event:"events.display.label.text.changed"}},behavior:{keyup:{event:"properties.label.text"},mousemove:{event:"properties.label.text"},change:{event:"properties.label.text"}}},"text-label":{type:"display.label",initial:{props:{left:220,top:130,width:40},attr:{text:"html content"}}},"font-family":{type:"display.form.dropdown",initial:{props:{left:10,top:200,width:200},attr:{labels:["Arial","Courier New","Georgia","Impact","Times New Roman","Trebuchet MS","Verdana"],values:["Arial","Courier New","Georgia","Impact","Times New Roman","Trebuchet MS","Verdana"]}},bind:{text:{event:"events.display.label.font-family.changed"}},behavior:{change:{event:"properties.label.font-family"}}},"font-family-label":{type:"display.label",initial:{props:{left:220,top:200},attr:{text:"typeface"}}},"font-size":{type:"display.form.textfield",initial:{props:{left:10,top:260,width:50},attr:{text:"12"}},bind:{text:{event:"events.display.label.font-size.changed"}},behavior:{change:{event:"properties.label.font-size"}}},"font-size-label":{type:"display.label",initial:{props:{left:70,top:260},attr:{text:"font-size"}}},"text-align":{type:"display.form.dropdown",initial:{props:{left:10,top:230,width:65},attr:{labels:["Left","Right","Center","Justify"],values:["left","right","center","justify"]}},bind:{text:{event:"events.display.label.text-align.changed"}},behavior:{change:{event:"properties.label.text-align"}}},"text-align-label":{type:"display.label",initial:{props:{left:85,top:230},attr:{text:"align"}}},"text-decoration":{type:"display.form.dropdown",initial:{props:{left:125,top:230,width:100},attr:{labels:["None","Underline","Overline","Line-through","Blink"],values:["none","underline","overline","line-through","blink"]}},bind:{text:{event:"events.display.label.text-decoration.changed"}},behavior:{change:{event:"properties.label.text-decoration"}}},"text-decoration-label":{type:"display.label",initial:{props:{left:235,top:230},attr:{text:"decorate"}}},"font-weight":{type:"display.form.dropdown",initial:{props:{left:125,top:260,width:100},attr:{labels:["Normal","Bold"],values:["normal","bold"]}},bind:{text:{event:"events.display.label.font-weight.changed"}},behavior:{change:{event:"properties.label.font-weight"}}},"font-weight-label":{type:"display.label",initial:{props:{left:235,top:260},attr:{text:"weight"}}}}}},u=e.fn.fluxui.$class.create({namespace:"properties.label",inherits:t.properties.propsheet,constructor:function(e,t){u.Super.constructor.call(this,e,t)},fields:{ens:"display.label"},methods:{initialise:function(t,n){var r=this;s.addListener("properties.label.*",function(t,n){r.handlePropertyChange(e(n.target))});u.Super.initialise.call(this,t,n)},update:function(){t.controls.colorpicker.current(this.getChildById("color"))}},statics:{create:function(){var e="display.label";t.serialiser.parse(e+".props",o,t.controls.properties.getInstance())}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=t.events.dispatcher.getInstance(),o={type:"properties.stage",initial:{props:{fill:{type:"linear",direction:"top",colors:[{rgb:"#cccccc",opacity:1,pos:0},{rgb:"#cccccc",opacity:1,pos:.63},{rgb:"#000000",opacity:1,pos:.635},{rgb:"#cccccc",opacity:1,pos:.64}]},position:"relative",width:300,height:100,overflow:"hidden"}},children:{keys:["width","width-label","height","height-label","fill","fill-label","transparent","transparent-label","id","id-label","class","class-label"],hash:{width:{type:"display.form.textfield",initial:{props:{left:10,top:10,width:50}},bind:{text:{event:"events.stage.width.changed"}},behavior:{change:{event:"properties.stage.width"}}},"width-label":{type:"display.label",initial:{props:{left:70,top:10,width:20},attr:{text:"w"}}},height:{type:"display.form.textfield",initial:{props:{left:10,top:40,width:50}},bind:{text:{event:"events.stage.height.changed"}},behavior:{change:{event:"properties.stage.height"}}},"height-label":{type:"display.label",initial:{props:{left:70,top:40,width:20},attr:{text:"h"}}},fill:{type:"controls.colorpicker",initial:{props:{left:100,top:8},attr:{allowGradient:!1}},bind:{color:{event:"events.stage.fill.changed"}},behavior:{change:{event:"properties.stage.fill"},click:{event:"color.request"}}},"fill-label":{type:"display.label",initial:{props:{left:130,top:10,width:100},attr:{text:"bgcolor"}}},transparent:{type:"display.form.checkbox",initial:{props:{left:104,top:40},attr:{checked:!0}},bind:{text:{event:"events.stage.transparent.changed"}},behavior:{change:{event:"properties.stage.transparent"}}},"transparent-label":{type:"display.label",initial:{props:{left:130,top:40},attr:{text:"transparent"}}},id:{type:"display.form.textfield",initial:{props:{left:10,top:70,width:80}},bind:{text:{event:"events.stage.id.changed"}},behavior:{change:{event:"properties.stage.id"}}},"id-label":{type:"display.label",initial:{props:{left:100,top:70,width:20},attr:{text:"id"}}},"class":{type:"display.form.textfield",initial:{props:{left:130,top:70,width:80}},bind:{text:{event:"events.stage.class.changed"}},behavior:{change:{event:"properties.stage.class"}}},"class-label":{type:"display.label",initial:{props:{left:220,top:70,width:40},attr:{text:"class"}}}}}},u=e.fn.fluxui.$class.create({namespace:"properties.stage",inherits:t.properties.propsheet,constructor:function(e,t){u.Super.constructor.call(this,e,t)},fields:{ens:"stage"},methods:{initialise:function(n,r){var i=this;s.addListener("properties.stage.*",function(t,n){i.handlePropertyChange(e(n.target))});t.controls.colorpicker.current(this.getChildById("fill"));u.Super.initialise.call(this,n,r)},handlePropertyChange:function(e){var t=e.attr("fluxid");switch(t){case"width":case"height":var n=parseInt(e.val());isNaN(n)||s.dispatch(this,"events.stage."+t,n);break;case"fill":var r=this.getChildById("fill");s.dispatch(this,"events.stage.fill",r)}},update:function(){t.controls.colorpicker.current(this.getChildById("fill"))}},statics:{create:function(){var e="stage";t.serialiser.parse(e+".props",o,t.controls.properties.getInstance())}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=i.create({namespace:"controls.accordion",inherits:t.display.element,constructor:function(e,t){s.Super.constructor.call(this,e,t)},methods:{initialise:function(){var n=this.initial;if(!!this.data.hash.button){var r=this.$node().children();for(var n=0;n<r.length;n++){var i=t.display.element.getInstance(r[n]),s=t.serialiser.parse(i.fluxid()+"-btn",this.data.hash.button);s.style("position","relative");var o=e(r[n]).wrap("<div></div>").parent();o.prepend(s.node);s.style("width",this.width);if(i.text!=""){var u=s.getChildById("label");u.states.setAttributeOnAllStates("text",i.text);u.text(i.text)}if(i.icon!=""){u=s.getChildById("icon");u.states.setAttributeOnAllStates("src",i.icon);u.attribute("src",i.icon)}e(r[n]).hide();!s.initialise||s.initialise(this.data.hash.button);var a=this;s.$node().bind("click",function(e){a.handleClick(e.currentTarget)})}}},handleClick:function(n){var r=e(n).next()[0];this.$node().find("[entity='controls.accordionPanel']").each(function(){if(this==r){t.display.element.getInstance(n).selected(!e(this).is(":visible"));e(this).toggle("fast")}else if(e(this).is(":visible")){t.display.element.getInstance(e(this).prev()).selected(!1);e(this).toggle("fast")}})},getChildren:function(e){e||(e="[entity=accordionPanel]");return s.Super.getChildren.call(this,e)}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=i.create({namespace:"controls.accordionPanel",inherits:t.display.element,constructor:function(e,t){s.Super.constructor.call(this,e,t)},fields:{props:{position:"relative"},text:"",icon:""},methods:{initialise:function(e,t){var n=this.states.getCurrentStateData().attr;this.text=n.text;!r[n.icon]||(this.icon=n.icon)}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=i.create({namespace:"controls.colorpicker",inherits:t.display.element,constructor:function(e,t){this.$node().bind("change",function(){});s.Super.constructor.call(this,e,t)},fields:{color:"#999999",opacity:1,allowGradient:!1},props:{width:20,height:20},methods:{initialise:function(e,n){var r=this;this.bg=new t.display.image(e+"_bg",{initial:{props:{width:r.width(),height:r.height()},attr:{src:"alpha-bg"}}});r.addChildFromClass(this.bg);this.bg.applyStateStyles();this.bg.applyStateAttributes();this.swatch=new t.display.element(e+"_swatch",{initial:{props:{width:r.width(),height:r.height(),fill:{type:"solid",colors:[{rgb:"#999999"}]}}}});r.addChildFromClass(this.swatch);this.swatch.applyStateStyles();r.$node().ColorPicker(this.pickerData());if(!!n.initial){var i=n.initial.attr;!i||(this.allowGradient=i.allowGradient==1)}var s=n.bind;if(!!s)for(var o in s)s.hasOwnProperty(o)&&(!s[o].event||t.events.dispatcher.getInstance().addListener(s[o].event,function(e,t){o=="color"?!t||r.setColor(t,!0):r.$node().attr(o,t)}))},pickerData:function(){var n=this;return{color:"#0000ff",onShow:function(r){var i=t.controls.colorpicker.current(n);e(r).fadeIn(500);e(r).ColorPickerSetColor(i.color,i.opacity);return!1},onHide:function(t){e(t).fadeOut(500);return!1},onChange:function(e,r,i){var s=t.controls.colorpicker.current(n);s.color="#"+r.substr(0,6);s.opacity=i.a/255;s.getChildAt(1).style("fill",{type:"solid",colors:[{rgb:s.color,opacity:s.opacity}]});s.$node().trigger("change")}}},setColor:function(e,n){e=this.color=t.core.isColor(e)?t.core.clone(e):{type:"solid",colors:[{rgb:e}]};this.swatch.style("fill",e);var r=e.colors;r[0].opacity?this.setOpacity(r[0].opacity):this.setOpacity(1);n?this.allowGradient==1&&t.controls.colorpicker._current==this&&t.events.dispatcher.getInstance().dispatch(this,"events.colorpicker.update",e,!0):this.$node().trigger("change")},setOpacity:function(e){if(isNaN(e))return;this.opacity=e}},statics:{_current:null,current:function(e){var n=t.controls.colorpicker;!e||(n._current=e);return n._current}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=i.create({namespace:"controls.gradientpicker",inherits:t.display.element,constructor:function(e,t){s.Super.constructor.call(this,e,t)},fields:{_counter:0,xOffset:30,color:{type:"solid",direction:"top",colors:[{rgb:"#999999",opacity:1,pos:.01},{rgb:"#999999",opacity:1,pos:.99}]}},methods:{initialise:function(e,n){var r=this;this.type=this.getChildById("color-type");this.type.$node().bind("change",function(e){r.updateGradient(!0)});this.angle=this.getChildById("color-angle");this.angle.$node().bind("change",function(e){r.updateGradient(!0)});this.view=this.getChildById("color-viewer");this.swatches=this.getChildById("swatch-panel");this.swatches.$node().bind("dblclick",function(e){r.type.$node().find("option:selected").prop("selected",!1);r.type.$node().find("option:nth-child(2)").prop("selected",!0);r.addSwatch(e.pageX-r.xOffset);r.updateSwatches(!0)});var i=n.bind;if(!!i)for(var s in i)i.hasOwnProperty(s)&&(!i[s].event||t.events.dispatcher.getInstance().addListener(i[s].event,function(e,t){s=="color"?!t||r.setColor(t,!0):r.$node().attr(s,t)}));t.events.dispatcher.getInstance().addListener("events.colorpicker.update",function(e,t,n){r.setColor(t,!!n)});this.updateSwatches()},addSwatch:function(e,n,r){var i=this;r=r||1;var s="swatch_"+this._counter++,o={initial:{props:{width:10,height:10}},states:{}},u=new t.controls.gradientswatch(s,o);this.swatches.addChildFromClass(u);u.applyStateStyles();u.x(e);u.initialise(s,o);!n||u.setColor(n,r,!1);u.$node().bind("change",function(e){i.updateSwatches(!0)});return u},setColor:function(e,n){if(!t.core.isColor(e))return;this.type.value(e.type);this.angle.value(e.direction);this.color=t.core.clone(e);this.swatches.empty();for(var r=0;r<this.color.colors.length;r++)var i=this.color.colors[r],s=this.swatches.width()*i.pos,o=this.addSwatch(s,i.rgb,i.opacity);this.updateGradient(!n)},updateSwatches:function(e){var n=this.swatches.getChildren();this.color.colors=[];for(var r=0;r<n.length;r++){t.core.isString(n[r].color)&&n[r].setColor(n[r].color,!0);n[r].include==1&&this.color.colors.push(n[r].color)}this.updateGradient(e)},updateGradient:function(e){var n;if(this.color.colors.length<1){n="";this.view.style("fill",n)}else{n={type:"linear",direction:360,colors:this.color.colors};this.view.style("fill",n)}n.direction=this.angle.value();n.type=this.type.value();e==1&&t.events.dispatcher.getInstance().dispatch(this,"color.gradient.update",n)}}}),o=i.create({namespace:"controls.gradientswatch",inherits:t.controls.colorpicker,constructor:function(e,t){s.Super.constructor.call(this,e,t)},fields:{include:!0},props:{width:10,height:10},methods:{initialise:function(n,r){o.Super.initialise.call(this,n,r);var i=this;if(t.interaction.eventSupport("touchstart")===!0){this.$node().bind("touchstart",function(e){i.selected=!0;i.btnDrag(e)});e(document).bind("touchend",function(e){i.selected&&i.btnDrop(e);i.selected=!1})}else{this.$node().bind("mousedown",function(e){i.selected=!0;i.btnDrag(e)});e(document).bind("mouseup",function(e){i.selected&&i.btnDrop(e);i.selected=!1})}},setColor:function(e,n){isNaN(n)&&(n=1);t.core.isColor(e)&&(e=e.colors[0].rgb);var r=this.makeColor(e);r.opacity=n;this.getChildAt(1).style("fill",{type:"solid",colors:[r]});this.color=r},makeColor:function(e){return{rgb:e,pos:(this.x()+this.width()/2)/this.parent().width()}},pickerData:function(){var t=this;return{color:"#0000ff",onShow:function(n){if(t.preventClick==1){t.preventClick=!1;return!1}var r=t;e(n).fadeIn(500);e(n).ColorPickerSetColor(r.color,r.opacity);return!1},onHide:function(t){e(t).fadeOut(500);return!1},onChange:function(e,n,r){var i=t;i.color=t.makeColor("#"+n.substr(0,6));i.color.opacity=i.opacity=r.a/255;i.getChildAt(1).style("fill",{type:"solid",colors:[i.color]});i.$node().trigger("change")}}},btnDrag:function(e){e==null&&(e=window.event);var t=this;t.startX=t.x();t.startY=e.clientY;document.onmousemove=function(e){t.btnMove(e)};document.body.focus();document.onselectstart=function(){return!1};this.$node().ondragstart=function(){return!1};return!1},btnDrop:function(e){document.onmousemove=null;document.onselectstart=null;this.color.pos=this.x()/this.parent().width();this.$node().trigger("change");this.startX!=this.x()&&(this.preventClick=!0);this.include==0&&this.remove()},btnMove:function(e){var n=t.display.element.getInstance(this.$node()),r=e.clientX-30;n.x(r);this.visible(this.include=e.clientY-this.startY<50);this.color.pos=r/this.parent().width();this.$node().trigger("change")},stopPropogation:function(e){e&&e.stopPropagation();window.event&&(window.event.cancelBubble=!0)}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,s=e.fn.fluxui.$class,o=t.selection.getInstance(),u=t.events.dispatcher.getInstance(),a=s.create({namespace:"controls.manipulator",inherits:t.display.element,constructor:function(e,t){a.Super.constructor.call(this,e,t)},methods:{initialise:function(){var n=this;u.addListener("stage.element.selected",function(e,r,i,s){if(!i)n.remove();else{n.attach(i,s);n.applyAttributes(n.states.initial.attr)}t.controls.manipulator.child=i});u.addListener("events.manipulator.click",function(e,t,r){n.lookUnder(t,r)});this.style("border","solid 1px #333333");this.style("overflow","visible");this.remove();var r=t.controls.manipulator.hndWidth,i={type:"element",initial:{props:{background:"#ffffff",width:r,height:r}}};this.$node().bind("click",this.stopPropogation);this.$node().bind("dblclick",function(e){n.doubleClick(e)});for(var s=0;s<8;s++){var o=new t.display.element("handle_"+s,i);o.applyStateStyles();o.style("border","solid 1px #333333");if(s==0||s>=6)o.style("left",-(r/2));else if(s>=2&&s<=4){o.style("right",-(r/2));o.removeStyle("left")}else{o.style("left","50%");o.style("margin-left",-(r/2))}if(s<=2)o.style("top",-(r/2));else if(s>=4&&s<=6){o.style("bottom",-(r/2));o.removeStyle("top")}else{o.style("top","50%");o.style("margin-top",-(r/2))}o.$node().bind("click",this.stopPropogation);if(t.interaction.eventSupport("touchstart")===!0){o.$node().bind("touchstart",this.btnDrag);e(document).bind("touchend",this.btnDrop)}else{o.$node().bind("mousedown",this.btnDrag);e(document).bind("mouseup",this.btnDrop)}this.addChild(o.node);o.applyStateAttributes()}},stopPropogation:function(e){e&&e.stopPropagation();window.event&&(window.event.cancelBubble=!0)},doubleClick:function(e){if(o.length()!=2)return this.stopPropogation(e);var n,r;for(var i=0;i<o.length();i++){r=t.display.element.getInstance(o.targets()[i]);!!r.fluxid&&r.fluxid()!="overlay"&&(n=r)}if(!n)return;u._dispatch("events.element.open",n);this.stopPropogation(e)},attach:function(e,n){n.shiftKey===!1&&this.remove();var r=t.display.element.getInstance(e);o.add(r.fluxid());this.reset()},reset:function(){for(i=0;i<8;i++)this.getChildById("handle_"+i).$node().toggle(o.length()==1);this.update()},update:function(){var e=this.getDimentions();if(!!e){this.width(e.w-e.l);this.height(e.h-e.t);this.x(e.l);this.y(e.t)}},lookUnder:function(t,n){var r=[],s=[],u;for(i=0;i<o.targets().length;i++)r.push(o.targets()[i][0]);if(this.comparePosition(r,t,n,"overlay")==0){u=this.comparePosition(e("[fluxid=stage]").children(),t,n,"overlay");if(u!=0){o.add(e(u).attr("fluxid"));this.update()}}},comparePosition:function(t,n,r,s){var o=[];for(i=t.length-1;i>=0;i--)if(e(t[i]).attr("fluxid")!=s){o=this.truePosition(t[i]);if(n>o[0]&&n<o[0]+e(t[i]).outerWidth()&&r>o[1]&&r<o[1]+e(t[i]).outerHeight())return t[i]}return!1},getDimentions:function(){var e,t,n,r,i=9999,s=9999,u=-9999,a=-9999,f,l=o.targets();if(!!l){for(e=0;e<l.length;e++)if(l[e].attr("fluxid")!=="overlay"){t=n=parseInt(l[e].css("left"));!isNaN(t)&&t<s&&(s=t);t=r=parseInt(l[e].css("top"));!isNaN(t)&&t<i&&(i=t);t=n+l[e].outerWidth();!isNaN(t)&&t>u&&(u=t);t=r+l[e].outerHeight();!isNaN(t)&&t>a&&(a=t)}return{l:s,t:i,w:u,h:a}}},remove:function(){o.clear();this.rect({x:-9999,y:-9999,w:10,h:10});t.controls.manipulator.child=null},btnDrag:function(n){var r=t.controls.manipulator.getInstance();n==null&&(n=window.event);var i=n.target!=null?n.target:n.srcElement,s=e(i).attr("fluxid");if(s.indexOf("handle_")==-1)return;var o=parseInt(s.split("handle_").join("")),u=0,a=0,f=t.controls.manipulator.hndWidth;if(o>=2&&o<=4)u=r.$node().width();else if(o==1||o==5)u=r.$node().width()/2;if(o>=4&&o<=6)a=r.$node().height();else if(o==3||o==7)a=r.$node().height()/2;r.selectedHndId=o;r._w=r.$node().width();r._h=r.$node().height();r._lo=parseInt(r.$node().offset().left);r._to=parseInt(r.$node().offset().top);r._l=parseInt(r.$node().css("left"));r._t=parseInt(r.$node().css("top"));r.dragElement=i;document.onmousemove=r.btnMove;document.body.focus();document.onselectstart=function(){return!1};i.ondragstart=function(){return!1};return!1},btnDrop:function(e){var n=t.controls.manipulator.getInstance();if(n.dragElement!=null){document.onmousemove=null;document.onselectstart=null;n.dragElement.ondragstart=null;n.dragElement=n.selectedHndId=n._h=n._w=n._l=n._t=n._lo=n._to=null;u.dispatch(n,"stage.element.change")}},btnMove:function(n){var r=t.controls.manipulator.getInstance(),i=t.display.element.getInstance(e(o.targets(0))),s=r.$node(),u=r.selectedHndId,a=null,f=parseInt(i.$node().css("border-left-width"))*2;if(n==null)var n=window.event;if(u>=4&&u<=6){var l=n.clientY-r._to;if(n.shiftKey===!0){s.width(r._w+(l-r._h));i.width(r._w+(l-r._h)-f,1)}s.height(l);i.height(l-f,1)}else if(u>=0&&u<=2){var c=n.clientY,h={top:c-(r._to-r._t)},p=r._to+r._h-c;s.css(h);i.y(h.top,1);s.height(p);i.height(p-f,1)}if(u>=2&&u<=4){a=n.clientX-r._lo;if(n.shiftKey===!0){s.height(r._h+(a-r._w));i.height(r._h+(a-r._w)-f,1)}s.width(a);i.width(a-f,1)}else if(u==0||u>=6){var d=n.clientX,l={left:d-(r._lo-r._l)};a=r._lo+r._w-d;s.css(l);i.x(l.left,1);s.width(a);i.width(a-f,1)}},getChildIds:function(){return[]},getChildren:function(){return[]}},statics:{child:null,hndWidth:10,getInstance:function(e,n){var r=t.controls.manipulator;r._inst||(r._inst=new r(e,n));return r._inst}}})})(jQuery,this);(function(e){var n=e.fn.fluxui.types,r=e.fn.fluxui.fdata,i=e.fn.fluxui.assets,s=e.fn.fluxui.$class,o=n.selection.getInstance(),u=n.events.dispatcher.getInstance(),a=function(e){return n.display.element.getInstance(e)};s.create({namespace:"controls.alignment",constructor:function(){var t=this;u.addListeners({"properties.align.*":function(e,n){t.align(e)},"properties.match.*":function(e,n){t.match(e)},"properties.distribute.*":function(e,n){t.distribute(e)},"properties.space.*":function(e,n){t.space(e)},"properties.anchor.*":function(n,r){t.anchor(n,a(e(r.target)).checked())},"properties.alignment":function(n,r){t.alignType(a(e(r.target)).value())}})},methods:{align:function(e){var r=o.targets(),i,s=n.display.element.getInstance,u=e.replace("properties.align.","");o.add("overlay");switch(u){case"left":i=parseInt(r[0].css("left"));for(t in r)r[t].attr("fluxid")!=="overlay"&&parseInt(r[t].css("left"))<i&&(i=parseInt(r[t].css("left")));for(t in r)r[t].css("left",i);break;case"right":i=parseInt(r[0].css("left"))+parseInt(r[0].outerWidth());for(t in r)r[t].attr("fluxid")!=="overlay"&&parseInt(r[t].css("left"))+parseInt(r[t].outerWidth())>i&&(i=parseInt(r[t].css("left"))+parseInt(r[t].outerWidth()));for(t in r)r[t].css("left",i-parseInt(r[t].outerWidth()));break;case"top":i=parseInt(r[0].css("top"));for(t in r)r[t].attr("fluxid")!=="overlay"&&parseInt(r[t].css("top"))<i&&(i=parseInt(r[t].css("top")));for(t in r)r[t].css("top",i);break;case"bottom":i=parseInt(r[0].css("top"))+parseInt(r[0].outerHeight());for(t in r)r[t].attr("fluxid")!=="overlay"&&parseInt(r[t].css("top"))+parseInt(r[t].outerHeight())>i&&(i=parseInt(r[t].css("top"))+parseInt(r[t].outerHeight()));for(t in r)r[t].css("top",i-parseInt(r[t].outerHeight()));break;case"center.x":i=0;for(t in r)r[t].attr("fluxid")!=="overlay"&&(i+=parseInt(r[t].css("left"))+parseInt(r[t].outerWidth())/2);for(t in r){var a=i/(r.length-1)-parseInt(r[t].outerWidth())/2,f=parseInt(r[t].css("left"));(a-f)*(a-f)>=2&&r[t].css("left",a)}break;case"center.y":i=0;for(t in r)r[t].attr("fluxid")!=="overlay"&&(i+=parseInt(r[t].css("top"))+parseInt(r[t].outerHeight())/2);for(t in r){var a=i/(r.length-1)-parseInt(r[t].outerHeight())/2,f=parseInt(r[t].css("top"));(a-f)*(a-f)>=2&&r[t].css("top",a)}break;default:console.log(u)}n.controls.manipulator.getInstance().update()},match:function(e){if(o.length()<1)return;var r=o.targets(),i,s=e.replace("properties.match.",""),u=0,a=0;if(s==="width"||s==="both"){for(t in r)r[t].attr("fluxid")!=="overlay"&&r[t].outerWidth()>u&&(u=r[t].outerWidth());for(t in r)r[t].attr("fluxid")!=="overlay"&&r[t].css("width",u-parseInt(r[t].css("border-left-width"))*2)}if(s==="height"||s==="both"){for(t in r)r[t].attr("fluxid")!=="overlay"&&r[t].outerHeight()>a&&(a=r[t].outerHeight());for(t in r)r[t].attr("fluxid")!=="overlay"&&r[t].css("height",a-parseInt(r[t].css("border-left-width"))*2)}n.controls.manipulator.getInstance().update()},distribute:function(e){if(o.length()<1)return;var t=n.controls.manipulator.getInstance,r=e.replace("properties.distribute.",""),i=t().getDimentions(),s=o.sort(r,"overlay"),u=s.length-1,a=parseInt(s[0].css("left")),f=parseInt(s[u].css("left")),l=parseInt(s[0].css("top")),c=parseInt(s[u].css("top"));for(nt=1;nt<u;nt++){if(r==="left"){var h=(f-a)/u,p=h*nt;s[nt].css("left",a+p)}if(r==="center.x"){var d=a+s[0].outerWidth()/2,v=f+s[u].outerWidth()/2,h=(v-d)/u,p=h*nt;s[nt].css("left",d+p-s[nt].outerWidth()/2)}if(r==="right"){var d=a+s[0].outerWidth(),v=f+s[u].outerWidth(),h=(v-d)/u,p=h*nt;s[nt].css("left",d+p-s[nt].outerWidth())}if(r==="top"){var h=(c-l)/u,p=h*nt;s[nt].css("top",l+p)}if(r==="center.y"){var d=l+s[0].outerHeight()/2,v=c+s[u].outerHeight()/2,h=(v-d)/u,p=h*nt;s[nt].css("top",d+p-s[nt].outerHeight()/2)}if(r==="bottom"){var d=l+s[0].outerHeight(),v=c+s[u].outerHeight(),h=(v-d)/u,p=h*nt;s[nt].css("top",d+p-s[nt].outerHeight())}}t().update()},space:function(e){if(o.length()<1)return;var t=n.controls.manipulator.getInstance,r=e.replace("properties.space.",""),i=t().getDimentions(),s=o.sort("center."+r,"overlay"),u=s.length-1,a=s[0].outerWidth(),f=s[u].outerWidth(),l=s[0].outerHeight(),c=s[u].outerHeight(),h=r==="x"?i.w-i.l-a-f:i.h-i.t-l-c,p=0;for(nt=1;nt<u;nt++)p=r==="x"?p+s[nt].outerWidth():p+s[nt].outerHeight();p=(h-p)/u;for(nt=1;nt<u;nt++)if(nt!==0&&nt!==u){r==="x"&&s[nt].css("left",parseInt(s[nt-1].css("left"))+s[nt-1].outerWidth()+p);r==="y"&&s[nt].css("top",parseInt(s[nt-1].css("top"))+s[nt-1].outerHeight()+p)}t().update()},alignType:function(t){var n=o.targets(),r;if(n.length<1)return;switch(t){case"none":for(r=0;r<n.length;r++)if(a(e(n[r])).fluxid()!="overlay"){a(e(n[r])).states.setAttributeOnCurrentState("anchor",null);a(e(n[r])).states.setAttributeOnCurrentState("center",null);a(e(n[r])).center(t)}break;case"anchor":break;case"horz":case"vert":case"both":for(r=0;r<n.length;r++)if(a(e(n[r])).fluxid()!="overlay"){a(e(n[r])).states.setAttributeOnCurrentState("anchor",null);a(e(n[r])).states.setAttributeOnCurrentState("center",t);a(e(n[r])).center(t)}}},anchor:function(e,t){console.log(e,t)}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,s=e.fn.fluxui.$class,o=t.events.dispatcher.getInstance(),u,a=s.create({namespace:"controls.library",inherits:t.display.element,constructor:function(e,t){a.Super.constructor.call(this,e,t);u=this},fields:{assetsOnStage:[],flatAssetList:{},assetBeingDragged:!1,mouseInWorkspace:!1,assetAdded:!1,assetInPreview:["",""]},methods:{container:function(){return this.getChildById("asset-list")},initialise:function(){var e=this;this.$node().find("[fluxid=preview]").bind("mousedown",function(t){o._dispatch("properties.library.preview.mousedown",e.assetInPreview[0],e.assetInPreview[1])});o.addListeners({"dialog.confirm.import-asset":function(t,n,r){e.handleImportDialogSubmit(n,r)},"properties.library.add":function(){e.handleAddAssetClick()},"properties.library.item.clicked":function(t,n,r,i){e.showPreview(n,r,i)},"properties.library.item.mousedown":function(t,n,r){e.mousedownOnAsset(n,r)},"properties.library.preview.mousedown":function(t,n,r){e.mousedownOnAsset(n,r)},"events.library.addedToStage":function(t,n){e.newestAsset(n)},"properties.library.item.removed":function(t,n){e.removeAsset(n)},"properties.library.dir.clicked":function(t,n){e.toggleDir(n)},"properties.library.dir.mousedown":function(t,n){e.mousedownOnDir(n)}})},mousedownOnAsset:function(t,n){var r=this,i=r.truePosition(e("[fluxid=stage]")[0]);e("body").unbind("mousemove",r.mousemove);e("body").bind("mousemove",{me:r,id:t,sp:i,label:n},r.mousemove);e("body").unbind("mouseup",r.mouseUp);e("body").bind("mouseup",{me:r,id:t},r.mouseup)},mousemove:function(t){var n=t.data.me,r=t.data.id,i=t.data.sp,s=t.data.label;if(n.assetBeingDragged===!1){n.addToStage(r,s);n.assetBeingDragged=!0}n.moveLatestAsset(t.pageX,t.pageY,i[0],i[1]);e("body").css("cursor","move")},mouseup:function(t){var n=t.data.me;e("body").unbind("mousemove",n.mousemove);e("body").unbind("mouseup",n.mouseUp);n.checkPosition(t.pageX);n.assetBeingDragged=!1;n.assetAdded=!1;e("body").css("cursor","default")},checkPosition:function(e){this.assetBeingDragged==1&&e<340&&this.removeFromStage()},moveLatestAsset:function(e,t,n,r){var i=this,s=i.assetsOnStage[i.assetsOnStage.length-1];if(!!s&&i.assetAdded==1){s.element.x(e-n-s.element.$node().outerWidth()/2,1);s.element.y(t-r-s.element.$node().outerHeight()/2,1)}},removeFromStage:function(){var e=this.assetsOnStage[this.assetsOnStage.length-1];e.element.remove();this.assetsOnStage.pop()},newestAsset:function(e){this.assetsOnStage.push({type:e.className,element:e});this.assetAdded=!0;e.resetSize()},addToStage:function(e,t){o.dispatch(this,"library.add",e,t)},addAsset:function(e,n){if(e==null||n==null)return;var s=e.split("/"),u,a=this.addDirectory(s[2],this.container()._fluxid);for(i=3;i<s.length-1;i++)a=this.addDirectory(s[i],a);u=this.getChildById(a).getChildById("files");if(!this.getChildById(a+"/"+n)){var f=this.data.hash["asset-button"],l=t.serialiser.parse(a+"/"+n,f,u);l.setUrl(e);l.setLabel(n);this.flatAssetList[n]={url:e};r[n]={url:e};o._dispatch("properties.library.item.added",n,e)}},removeAsset:function(e){delete this.flatAssetList[e]},showPreview:function(e,t,n){this.assetInPreview=[e,n];var r=this.getChildById("preview"),i=this.getChildById("asset-viewer");r.src(t);r.x(i.width()/2-r.width()/2);r.y(i.height()/2-r.height()/2)},getAssets:function(){return this.flatAssetList},handleAddAssetClick:function(){var e=t.controls.dialog.getInstance();if(!e.isOpen()){e.setContent(e.importAsset);e.show()}},handleImportDialogSubmit:function(e,n){u.addAsset(n,e);t.controls.dialog.getInstance().hide()},clear:function(){var e=this.container().getChildren();for(var t=0;t<e.length;t++)e[t].remove()},addDirectory:function(n,r){var i=this.data.hash["directory-button"],s,o,u=this.getChildById(r);parentDirs=u.getChildById("sub-dirs"),dirId=r+"/"+n;if(parentDirs.getChildById(dirId)==null&&!!i){s=t.serialiser.parse(dirId,i,parentDirs);s.setLabel(n);o=s.$node().find("[fluxid=dir-label]").first();o.css({"box-shadow":"inset 1px 2px 3px #b0b0b0","background-color":"#cfcfcf"});o.hover(function(){e(this).css({"box-shadow":"0 0 2px #b0b0b0","background-color":"#cfd2cf"})},function(){e(this).css({"box-shadow"
:"inset 1px 2px 3px #b0b0b0","background-color":"#cfcfcf"})})}return dirId},toggleDir:function(e,t){var n=this.getChildById(e),r=n.getChildById("sub-dirs").getChildren();files=n.getChildById("files").getChildren();if(t!="show"||t!="hide"){for(i=0;i<r.length;i++)r[i].$node().toggle(300);for(i=0;i<files.length;i++)files[i].$node().toggle(300)}if(t=="show"){for(i=0;i<r.length;i++){console.log(r[i].$node());r[i].$node().show(300)}for(i=0;i<files.length;i++){console.log(files[i].$node());files[i].$node().show(300)}}if(t=="hide"){for(i=0;i<r.length;i++)r[i].$node().hide(300);for(i=0;i<files.length;i++)files[i].$node().hide(300)}},moveDir:function(e,n){if(this.ancestor(e.$node(),n.$node(),1,0)==0){this.toggleDir(e._fluxid,"show");e.getChildById("sub-dirs").addChildFromClass(n)}else{var r=t.controls.dialog.getInstance();r.showAlert("Cannot move directory into one of its sub directories")}},mousedownOnDir:function(t){var n=this,r=n.truePosition(e("[fluxid=stage]")[0]);e("[fluxid=dir-label]").unbind("mouseup",n.dirMouseUp);e("[fluxid=dir-label]").bind("mouseup",{me:n,id:t},n.dirMouseup)},dirMouseup:function(t){var n=t.data.id,r=t.data.me,i=r.getChildById(n),s=i.parent().parent(),o=s._fluxid,u=e(t.target).parent().attr("fluxid"),a=r.getChildById(u);u!=n&&u!=o&&r.moveDir(a,i)}}}),f=s.create({namespace:"controls.libitem",inherits:t.display.element,constructor:function(e,t){f.Super.constructor.call(this,e,t)},methods:{initialise:function(){var e=this;this.$node().bind("click",function(){e.click()});this.$node().bind("hover",function(){e.click()});this.$node().bind("mousedown",function(){e.mousedown()});this.getChildById("asset-btn").$node().bind("click",function(){e.remove()})},setUrl:function(e){this.url=e},setLabel:function(e){this.label=e;this.getChildById("asset-label").text(e)},click:function(){o._dispatch("properties.library.item.clicked","img",this.url,this.label)},mousedown:function(){o._dispatch("properties.library.item.mousedown","img",this.label)},remove:function(){var e=this.getChildById("asset-label").text();this.$node().remove();o._dispatch("properties.library.item.removed",e)}}}),l=s.create({namespace:"controls.libdir",inherits:t.display.element,constructor:function(e,t){f.Super.constructor.call(this,e,t)},methods:{initialise:function(){var e=this;this.getChildById("dir-label").$node().bind("dblclick",function(){e.click()});this.getChildById("dir-btn").$node().bind("click",function(){e.remove()});this.getChildById("dir-label").$node().bind("mousedown",function(){e.dragDir()});this.$node().css({"-moz-user-select":"-moz-none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none"})},setLabel:function(e){this.label=e;this.getChildById("dir-label").text(e)},click:function(){o._dispatch("properties.library.dir.clicked",this._fluxid)},dragDir:function(){o._dispatch("properties.library.dir.mousedown",this._fluxid)},remove:function(){var e=this.getChildById("dir-label").text();this.$node().remove();o._dispatch("properties.library.dir.removed",e)}}})})(jQuery,this);(function($){var types=$.fn.fluxui.types,fdata=$.fn.fluxui.fdata,assets=$.fn.fluxui.assets,$class=$.fn.fluxui.$class,eventDispatcher=types.events.dispatcher.getInstance(),clazz=$class.create({namespace:"controls.components",inherits:types.display.element,constructor:function(e,t){clazz.Super.constructor.call(this,e,t)},fields:{compsOnStage:[],compInPreview:""},methods:{container:function(){return this.getChildById("component-list")},initialise:function(){var me=this;this.$node().find("[fluxid=preview]").bind("mousedown",function(e){eventDispatcher._dispatch("properties.component.preview.mousedown",me.compInPreview,e.pageX,e.pageY)});eventDispatcher.addListeners({"properties.component.item.hover":function(e,t){me.showPreview(t)},"properties.component.item.mousedown":function(e,t,n,r){me.mousedownOnPanel(t,n,r)},"properties.component.preview.mousedown":function(e,t,n,r){me.mousedownOnPanel(t,n,r)},"events.components.addedToStage":function(e,t){me.newestComponent(t)}});$.post(types.core.securePath+"component/list",{},function(data){data=eval(data).D;if(types.core.isArray(data)&&data.length>0)for(var i=0;i<data.length;i++)me.addComponent(data[i],data[i].split("-").join(" "))});$("body").append('<img fluxid="compPreviewPic" src="" style="position: absolute; display: none" />')},mousedownOnPanel:function(e,t,n){var r=this;$("body").unbind("mousemove",r.mousemove);$("body").bind("mousemove",{me:r,id:e},r.mousemove);$("body").unbind("mouseup",r.mouseUp);$("body").bind("mouseup",{me:r,id:e,x:t,y:n},r.mouseup)},mousemove:function(e){var t=$("[fluxid=compPreviewPic]");t.attr("src",types.core.securePath+"component/"+e.data.id+"/preview");t.css({display:"block",left:e.pageX-t[0].width/2,top:e.pageY-t[0].height/2});$("body").css("cursor","move")},mouseup:function(e){var t=e.data.me,n=e.data.id,r=e.data.x,i=e.data.y;if(e.pageX>340){t.compsOnStage.push({type:n,element:{},x:e.pageX,y:e.pageY});t.addToStage(n)}else if(e.pageX<=r+5&&e.pageX>=r-5&&e.pageY<=i+5&&e.pageY>=i-5){t.compsOnStage.push({type:n,element:{},x:0,y:0});t.addToStage(n)}$("body").unbind("mousemove",t.mousemove);$("body").unbind("mouseup",t.mouseUp);$("[fluxid=compPreviewPic]").css("display","none");$("body").css("cursor","default")},moveLatestComp:function(){var e=this.compsOnStage[this.compsOnStage.length-1],t=e.element,n=e.x,r=e.y,i=this.truePosition($("[fluxid=stage]")[0]);if(n!=0&&r!=0){t.x(n-i[0]-t.$node().outerWidth()/2,1);t.y(r-i[1]-t.$node().outerHeight()/2,1)}else{var s=types.core.stageCascade();t.x(s);t.y(s)}},removeFromStage:function(){var e=this.compsOnStage[this.compsOnStage.length-1];e.element.remove();this.compsOnStage.pop()},newestComponent:function(e){this.compsOnStage[this.compsOnStage.length-1].element=e;this.moveLatestComp()},addToStage:function(e){$.post(types.core.securePath+"component/"+e+"/json").complete(function(e){eventDispatcher.dispatch(this,"components.add",e.responseText)})},addComponent:function(e,t){var n=this.data.hash["component-button"];if(!!n){var r=types.serialiser.parse("component_"+types.core.nextElementCounter(),n,this.container());r.setId(e);r.setLabel(t);r.setIcon(types.core.securePath+"component/"+e+"/icon");types.controls.properties.getInstance().loadSheet(types.core.securePath+"component/"+e+"/props","properties."+e)}eventDispatcher._dispatch("properties.components.item.added",t,e)},showPreview:function(e){this.compInPreview=e;this.getChildById("preview").src(types.core.securePath+"component/"+e+"/preview")},getComponents:function(){var e={},t=this.container().getChildren();for(var n=0;n<t.length;n++)e[t[n].label]={id:t[n].comId};return e},clear:function(){var e=this.container().getChildren();for(var t=0;t<e.length;t++)e[t].remove()}}}),clazb=$class.create({namespace:"controls.componentitem",inherits:types.display.element,constructor:function(e,t){clazb.Super.constructor.call(this,e,t)},methods:{initialise:function(){var e=this;this.$node().bind("hover",function(){e.hover()});this.$node().bind("mousedown",function(t){e.mousedown(t)})},setId:function(e){this.comId=e},setLabel:function(e){this.label=e;this.getChildById("component-label").text(e)},setIcon:function(e){this.icon=e;this.getChildById("component-icon").src(e)},hover:function(){eventDispatcher._dispatch("properties.component.item.hover",this.comId)},mousedown:function(e){eventDispatcher._dispatch("properties.component.item.mousedown",this.comId,e.pageX,e.pageY)}}})})(jQuery,this);(function(e){var t=e.fn.fluxui.types,n=e.fn.fluxui.fdata,r=e.fn.fluxui.assets,i=e.fn.fluxui.$class,s=t.events.dispatcher.getInstance(),o=t.selection.getInstance(),u=function(e){return t.display.element.getInstance(e)},a=i.create({namespace:"controls.explorer",inherits:t.display.element,constructor:function(e,t){a.Super.constructor.call(this,e,t)},fields:{compsOnStage:[],compInPreview:""},methods:{container:function(){return this.getChildById("explorer-list")},initialise:function(){var e=this;s.addListeners({"events.explorer.update":function(){e.refresh()}})},refresh:function(){this.clear();var e=this.target.currentItem.getChildren(),n=this.data.hash["explorer-button"];if(!!n)for(var r=0;r<e.length;r++){var i=t.serialiser.parse("explorer_"+t.core.nextElementCounter(),n,this.container());r%2==0&&i.getChildById("explorer-bg").style("fill",{type:"solid",colors:[{rgb:"#dfdfdf"}]},!0);i.setLabel(e[r].fluxid());i.setChild(e[r])}},clear:function(){var e=this.container().getChildren();for(var t=0;t<e.length;t++)e[t].remove()}}}),f=i.create({namespace:"controls.exploreritem",inherits:t.display.button,constructor:function(e,t){f.Super.constructor.call(this,e,t)},methods:{initialise:function(e,t){f.Super.initialise.call(this,e,t);var n=this;this.click(this,function(){this.selected(!this.isSelected);this.isSelected?o.select(!0,this.child.fluxid()):o.remove(this.child.fluxid());s.dispatch(this,"stage.manipulator.reset")});s.addListener("stage.element.*",function(){n.elementSelected()});s.addListener("events.stage.*",function(){n.elementSelected()})},setId:function(e){this.comId=e},setLabel:function(e){this.label=e;var t=this.getChildById("explorer-label");t.text(e);t.states.setAttributeOnAllStates("text",e)},setIcon:function(e){this.icon=e;this.getChildById("explorer-icon").src(e)},setChild:function(e){this.child=e;this.selected(o.indexOf(this.child.fluxid())>-1)},getChild:function(){return this.child},hover:function(){s._dispatch("properties.explorer.item.hover",this.comId)},mousedown:function(e){s._dispatch("properties.explorer.item.mousedown",this.comId,e.pageX,e.pageY)},elementSelected:function(){this.selected(o.indexOf(this.child.fluxid())>-1)}}})})(jQuery,this);$(document).ready(function(){var $$class=$.fn.fluxui.$class,types=$.fn.fluxui.types,assets=$.fn.fluxui.assets,selection=types.selection.getInstance(),eventDispatcher=types.events.dispatcher.getInstance(),inst=function(e){return types.display.element.getInstance(e)};$$class.create({namespace:"editor",constructor:function(e){var t=this;this.ed=$("#movie-container");this.ws=e.getChildById("workspace");this.stage=e.getChildById("stage");this.container=e.getChildById("stage-container");this.view=e.getChildById("view");this.menu=e.getChildById("menu");this.hud=e.getChildById("hud");this.library=e.getChildById("library-panel");this.explorer=e.getChildById("explorer-panel");this.explorer.target=this;this.propPanel=e.getChildById("propSheets");this.colorPanel=e.getChildById("color-panel");this.statePanel=types.controls.statePanel.getInstance();this.breadcrumbs=e.getChildById("breadcrumbs");$("body").css({overflow:"hidden",margin:0,padding:0});this.currentItem=this.stage;this.manipulator=types.controls.manipulator.getInstance("overlay",this.manipulatorObj);this.applyContext(this.manipulator);this.manipulator.applyStateStyles();this.hud.addChild(this.manipulator.node);this.manipulator.initialise();this.manipulator.applyStateAttributes();this.initialise(e)},fields:{ed:null,ws:null,stage:null,hud:null,view:null,movie:null,menu:null,library:null,elementCounter:0,currentItem:null,manipulatorObj:{initial:{attr:{drag:{restraint:"workspace",ondrag:"stage.element.drag",ondrop:"stage.element.drop"}}},frames:{keys:[],hash:{}}},eventDispatcher:null,manipulator:null,propPanel:null,colorPanel:null,stageScale:1},methods:{initialise:function(e){var t=this,n=this.ws,r=this;types.selection.initGlobalSelection();types.core.devMode=!0;var i=types.properties;i.stage.create();i.container.create();i.button.create();i.image.create();i.label.create();this.breadcrumbs.setLevel(this.stage);this.statePanel.populate(this.stage);this.stage.broadcast=function(){eventDispatcher.dispatch(t.stage,"events.stage.changed",t.stage)};var s=this.container.$node();s.bind("click",function(e){t.manipulator.remove();t.showPropertySheet("stage");t.stage.broadcast()});s.bind("dblclick",function(e){t.closeElement()});s.bind("mousewheel",function(e,t){e.preventDefault();t>0&&eventDispatcher.dispatch(this,"events.mousewheel.up");t<0&&eventDispatcher.dispatch(this,"events.mousewheel.down")});$(window).resize(function(){t.ed.width($(this).width());t.ed.height($(this).height());t.updateHud()}).trigger("resize");this.ws.$node().resize(function(){t.handleWorkspaceResize()});s.find("[fluxid=overlay]").click(function(e){e.shiftKey==1&&eventDispatcher.dispatch(this,"events.manipulator.click",e.pageX,e.pageY)});eventDispatcher.dispatch(this,"events.stage.width.changed",this.stage.width());eventDispatcher.dispatch(this,"events.stage.height.changed",this.stage.height());eventDispatcher.dispatch(this,"events.stage.id.changed",this.stage.attribute("id"));eventDispatcher.dispatch(this,"events.stage.class.changed",this.stage.attribute("class"));eventDispatcher.dispatch(this,"events.stage.fill.changed",this.stage.style("fill"));eventDispatcher.addListeners({"events.stage.width":function(e,n){t.stage.width(n);t.stage.center("both");t.updateHud()},"events.stage.height":function(e,n){t.stage.height(n);t.stage.center("both");t.updateHud()},"events.stage.fill":function(e,n){var r=n.color;types.core.isString(r)&&(r={type:"solid",colors:[{rgb:r,opacity:1,pos:.1}]});t.stagecolor=r;t.stage.style("fill",r,1)},"color.gradient.update":function(e,t){var n=types.controls.colorpicker.current();n.allowGradient&&n.setColor(t)},"controls.add.*":function(e,n){e=e.replace("controls.add.","");t.addElement(e,!0)},"components.add":function(e,n){t.addComponent(n)},"stage.element.selected":function(e,n,r,i){t.showPropertySheet.call(t,inst(r).entity());t.handleElementChange.call(t,e,n,r,i)},"stage.element.change":t.handleElementChange,"stage.element.dropped":t.handleElementChange,"properties.library.item.added":function(e,n,r){t.propPanel.getChildById("src").addItem(n)},"properties.library.item.removed":function(e,n){t.propPanel.getChildById("src").removeItem(n)},"library.add":function(e,n,r){t.addElement(n,!1,"library",r)},"events.element.open":function(){t.openElement()},"breadcrumbs.crumb.clicked":function(e,n){var r=inst($(n.target));r.className!="controls.crumb"&&(r=r.parent());if(r.current==0)while(t.currentItem!=t.stage&&t.view.pointer!=r.ref)t.closeElement()},"menu.click.*":function(e){t.handleMenu(e)},"dialog.confirm.save-movie":function(e,n){t.movieName=n;t.save(n);types.controls.dialog.getInstance().hide()},"dialog.confirm.open-movie":function(e,n){t.open(n);types.controls.dialog.getInstance().hide()},"dialog.confirm.register-user":function(e,n,r,i){t.register(n,r,i)},"events.keys.press":function(){t.keyDown.apply(t,Array.prototype.slice.call(arguments))},"events.mousewheel.up":function(){r.zoomIn()},"events.mousewheel.down":function(){r.panOut()},"stage.manipulator.reset":function(){r.manipulator.reset()}});this.setupKeys();this.alignment=new types.controls.alignment;this.propPanel.getChildById("src").addItem("-- Please select --","-");this.showPropertySheet("stage");this.ed.bind("dragstart",function(e){if(e.target.nodeName.toUpperCase()=="IMG")return!1});this.ed.css({"-moz-user-select":"-moz-none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none"})},newRequest:function(e){this.postSaveCB=null;var t=this;if(this.stage.numChildren()>0&&!e&&confirm("Do you wish to save your current project?")){this.postSaveCB=function(){t.newRequest(!0)};this.saveRequest();return}this.newProject()},saveRequest:function(){var e=types.controls.dialog.getInstance();if(!e.isOpen()){this.closeToStage();if(this.movieName==null){var e=types.controls.dialog.getInstance();e.setContent(e.saveMovie);e.show()}else this.save(this.movieName)}},openRequest:function($force){this.postSaveCB=null;var ed=this;if(this.stage.numChildren()>0&&!$force&&confirm("Do you wish to save your current project?")){this.postSaveCB=function(){ed.openRequest(!0)};this.saveRequest();return}$.ajax({url:types.core.securePath+"list"}).done(function(data){ed.updateOpenDialog(eval(data))})},updateOpenDialog:function(e){var t=e;if(t.E!=null&&types.core.isArray(t.E))return this.showAlert("Unable to retrieve your files. "+t.E[0]);var n=types.controls.dialog.getInstance();if(!n.isOpen()){this.closeToStage();var n=types.controls.dialog.getInstance(),r=n.getChildById(n.fileOpenList);r.removeAll();r.addItem("-- Please Select --","-");for(var i=0;i<t.D.length;i++)r.addItem(t.D[i]);n.setContent(n.openMovie);n.show()}},loginRequest:function(data){var u=this.menu.getChildById("user-txt"),p=this.menu.getChildById("pass-txt"),ed=this;$.post(types.core.securePath+"login",{u:u.text(),p:p.text()},function(data){var d=eval(data);if(d.E!=null)return types.core.isArray(d.E)&&d.E[0]=="not found"?this.showAlert("Unable to login. Did you enter the correct user and pass?"):this.showAlert("An error occurred on the server. If the problem persists, please contact an administrator.");ed.menu.showOptions()})},registerRequest:function(e){var t=types.controls.dialog.getInstance();if(!t.isOpen()){t.setContent(t.registerUser);t.show()}},embedRequest:function(){var e=this;if(this.movieName==null)return this.showAlert("Please save your project before requesting to embed.");$.post(types.core.securePath+"snippet/"+this.movieName,{},function(t){e.embed(t)})},previewRequest:function(){var e=this;if(this.movieName==null)return this.showAlert("Please save your project before requesting to preview.");$.post(types.core.securePath+"preview/"+this.movieName,{},function(t){var n=t,r=e.propPanel.propSheets.stage,i=parseInt(r.getChildById("width").text()),s=parseInt(r.getChildById("height").text());e.newWindow=window.open(types.core.securePath+"preview/"+e.movieName,"sub","status,height="+(s+50)+",width="+(i+50))})},save:function($name){var f={};f.movie=types.serialiser.encode(this.stage);f.assets=this.library.getAssets();var s=this.propPanel.propSheets.stage;f.movie.initial={props:{width:s.getChildById("width").text(),height:s.getChildById("height").text()},attr:{id:s.getChildById("id").text(),"class":s.getChildById("class").text()}};s.getChildById("transparent").checked()||(f.movie.initial.props.fill={type:"solid",colors:[{rgb:s.getChildById("stage-color-picker").color,opacity:1}]});var d=JSON.stringify(f),ed=this;$.post(types.core.securePath+"put",{title:$name,data:d},function(data){var d=eval(data);if(d.E!=null)return this.showAlert("Could not save. Please login, then try again.");var cb=ed.postSaveCB;ed.postSaveCB=null;!cb||cb()})},open:function($filename){var ed=this;$.post(types.core.securePath+"get/"+$filename,{},function(data){var d=eval(data);ed.addMovie(d.D.data,ed.stage,d.D.name);statePanel.populate(ed.stage)})},register:function(user,pass,email){var d=types.controls.dialog.getInstance();$.post(types.core.securePath+"register",{u:user,p:pass,e:email},function(data){var i=eval(data);if(i.E==null){d.hide();this.showAlert("User successfully registered. Please login.")}else types.core.isArray(i.E)?this.showAlert(i.E[0]):this.showAlert(i.E)})},embed:function(e){var t=types.controls.dialog.getInstance();t.getChildById(t.embedTxt).text(e);t.setContent(t.embedMovie);t.show()},newProject:function(){this.closeToStage();this.showPropertySheet("stage");this.movieName=null;this.stage.empty();this.stage.width(400);this.stage.height(300);this.library.clear()},addMovie:function(data,view,name,$type){var i,newMov,movie=JSON.parse(data),m=movie.movie,l=movie.assets,me=this;if(!!m.children)var c=m.children;if(!!name){this.newProject();this.movieName=name}for(i in l)l.hasOwnProperty(i)&&this.library.addAsset(l[i].url,i);eval("var json = "+data);var process=function(){if(!!c)for(i=0;i<c.keys.length;i++){newMov=types.serialiser.parse(c.keys[i],c.hash[c.keys[i]],view);newMov.fui_selectable=!0;me.applyContext(newMov);!$type||eventDispatcher.dispatch(newMov,"events."+$type+".addedToStage",newMov)}types.core.processElement(view,function(e){e.fui_selectable=!0;me.applyContext(e);e.$node().bind("click",e.fui_select)});if(!!name){var e=json.movie.initial.props;eventDispatcher.dispatch(me,"events.stage.width.changed",me.stage.width(parseInt(e.width)));eventDispatcher.dispatch(me,"events.stage.height.changed",me.stage.height(parseInt(e.height)));eventDispatcher.dispatch(me,"events.stage.fill.changed",me.stage.height(e.fill));me.stage.frames=types.core.clone(json.movie.frames)}me.statePanel.populate(me.stage)},list=types.loader.classesToLoad(json.movie);list.length>0?types.loader.load(list,function(){process()}):process()},addElement:function(e,t,n,r){var i,s=types.display.element.make;switch(e){case"div":i="container";break;case"img":i="image";break;case"lbl":i="label";break;case"btn":i="button";break;default:i="element"}var o=s("display."+i,null,this.makeState(i,null,{src:r}));o.applyStateStyles();this.currentItem.addChild(o.node);!o.initialise||o.initialise();o.applyStateAttributes();var u=types.core.stageCascade();o.x(u);o.y(u);o.fui_selectable=!0;this.applyContext(o);o.$node().bind("click",o.fui_select);if(!!t&&t==1){selection.select(!1,o.fluxid());o.$node().trigger("click")}eventDispatcher.dispatch(o,"events.explorer.update");!n||eventDispatcher.dispatch(o,"events."+n+".addedToStage",o)},addComponent:function(e){this.addMovie(e,this.currentItem,null,"components");eventDispatcher.dispatch(j,"events.explorer.update");eventDispatcher.dispatch(this,"components.latest.addedToStage")},openElement:function(){var e=selection.targets();for(var t=0;t<2&&e.length==2;t++)if(e[t].attr("fluxid")!="overlay"){eventDispatcher.dispatch(this,"events.stage.level.change",inst(e[t]));this.render(inst(e[t]))}this.explorer.refresh()},closeElement:function(){if(this.currentItem!=this.stage){eventDispatcher.dispatch(this,"events.stage.level.change",this.view.pointer.parent());this.render(this.view.pointer.parent())}this.explorer.refresh()},closeToStage:function(){while(this.currentItem==this.view)this.closeElement()},render:function(e){var t=e.entity(),n=e==this.container||e==this.stage;if(!!e.isContainer||n){this.manipulator.remove();n?this.showStage():this.showView();if(this.view.pointer!=null){var r=this.view._children.splice(0);this.view.pointer.empty();for(var i=0;i<r.length;i++)this.view.pointer.addChildFromClass(r[i]);this.view.pointer.frames=this.view.frames}this.view.pointer=n?null:e;this.view.empty();this.view.width(e.width());this.view.height(e.height());var r=e._children.splice(0);for(var i=0;i<r.length;i++){this.currentItem.addChild(r[i].$node());r[i].fui_selectable=!0;this.applyContext(r[i]);r[i].$node().bind("click",r[i].fui_select)}this.currentItem.frames=e.frames;this.manipulator.remove();this.showPropertySheet("stage");this.statePanel.populate(this.currentItem)}},showStage:function(){this.stage.visible(!0);this.view.visible(!1);this.currentItem=this.stage},showView:function(){this.stage.visible(!1);this.view.visible(!0);this.currentItem=this.view},moveForward:function(e){types.core.isArray(e)||(e=[e]);this.changeIndex(e,1)},moveBack:function(e){types.core.isArray(e)||(e=[e]);this.changeIndex(e,-1)},move:function(e,t){var n=types.controls.manipulator.getInstance(),r=selection.targets(),i,s=function(e,t,n){var r=inst(e),i=r[t]()+n;r[t](i,1)};for(i=0;i<r.length;i++)r[i].attr("fluxid")!="overlay"&&s(r[i],e,t);n[e](n[e]()+t)},deleteItems:function(e){var t,n=selection.targets();if(n.length<1)return;if(!!e||confirm("Deleting an item is permanent. Are you sure?")){for(t=0;t<n.length;t++)n[t].attr("fluxid")!="overlay"&&n[t].remove();this.stage.$node().trigger("click")}},zoomIn:function(){if(this.stageScale<2.98){this.stageScale=this.stageScale+.02;this.scale()}},panOut:function(){if(this.stageScale>.22){this.stageScale=this.stageScale-.02;this.scale()}},fullScale:function(){this.stageScale=1;this.scale()},fullPanOut:function(){this.stageScale=.2;this.scale()},scale:function(){$("[fluxid=stage-container]").css("transform","scale("+this.stageScale+")");$("[fluxid=stage-container]").css("-moz-transform","scale("+this.stageScale+")");$("[fluxid=stage-container]").css("-webkit-transform","scale("+this.stageScale+")");$("[fluxid=stage-container]").css("-o-transform","scale("+this.stageScale+")");$("[fluxid=stage-container]").css("-ms-transform","scale("+this.stageScale+")")},cutItems:function(){var e,t=selection.targets();this.clipboard=[];if(t.length<1)return;for(e=0;e<t.length;e++)t[e].attr("fluxid")!="overlay"&&this.clipboard.push({fluxid:t[e].attr("fluxid"),data:types.serialiser.encode(inst(t[e]))});for(e=0;e<t.length;e++)t[e].attr("fluxid")!="overlay"&&t[e].remove();this.stage.$node().trigger("click");console.log(this.clipboard)},copyItems:function(){var e,t=selection.targets();this.clipboard=[];if(t.length<1)return;for(e=0;e<t.length;e++)t[e].attr("fluxid")!="overlay"&&this.clipboard.push({fluxid:t[e].attr("fluxid"),data:types.serialiser.encode(inst(t[e]))})},pasteItems:function(){var e,t=this.clipboard,n=this.currentItem,r=this;if(!t||t.length<1)return;for(e=0;e<t.length;e++){var i=t[e].fluxid+"_copy",s=2;while($("[fluxid='"+i+"_"+s+"']").length>0)s++;newMov=types.serialiser.parse(i+"_"+s,t[e].data,n);newMov.fui_selectable=!0;newMov.$node().bind("click",newMov.fui_select);this.applyContext(newMov)}},selectAllItems:function(){var e=this.currentItem.getChildren();for(var t=0;t<e.length;t++)selection.select(!0,e[t].fluxid());this.manipulator.reset();eventDispatcher.dispatch(this,"events.stage.selectAll")},changeIndex:function(e,t){e.sort(function(e,t){var n=e.index(),r=t.index();return n<r?-1:n>r?1:0});var n,r,i,s,o;for(var u=0;u<e.length;u++){n=e[u];r=n.index();i=n.parent();s=inst(n.get(0));if(t<=0&&r==0)continue;if(t>0&&r==i.children().length-1)continue;n.remove();t>0?n.insertAfter(i.children().get(r)):n.insertBefore(i.children().get(r-1));s.node=n.get(0);n.data("currentInstance",s);n.bind("click",s.fui_select)}},applyContext:function(e){var t=this;e.$node().get(0).oncontextmenu=function(){e!=t.manipulator&&e.$node().trigger("click");return!1};e.$node().contextPopup({title:"Options",items:[{label:"Cut",icon:"assets/icons/cut.png",action:function(){t.cutItems()}},{label:"Copy",icon:"assets/icons/copy.png",action:function(){t.copyItems()}},{label:"Paste",icon:"assets/icons/paste.png",action:function(){t.pasteItems()}},null,{label:"Delete",icon:"assets/icons/delete.png",action:function(){t.deleteItems()}},null,{label:"About...",icon:"assets/icons/about.png",action:function(){t.about()}}]})},showAlert:function(e){var t=types.controls.dialog.getInstance();t.showAlert(e)},handleMenu:function(e){this[e.split(".").pop()+"Request"]()},handleElementChange:function(e,t,n,r){!r||selection.select(r.shiftKey,$(n).attr("fluxid"));var i=selection.targets(0),s=inst(i);!!s&&!!s.broadcast&&s.broadcast()},handleWorkspaceResize:function(){var e,t=this.container.$node();q=this.ws.$node();t.height()>q.height()&&q.scrollTop((t.height()-q.height())/2);t.width()>q.width()&&q.scrollLeft((t.width()-q.width())/2);e=this.ws.getChildById("overlay");!e.update||e.update()},showPropertySheet:function(e){this.propPanel.showSheet(e)||this.propPanel.showSheet("display.container")},updateHud:function(){this.hud.x(this.currentItem.x());this.hud.y(this.currentItem.y())},setupKeys:function(){var e=inst(this.ed).actions,t=types.interaction;e.initKeys();e.bindKey(t.keys.UP_ARROW,"up");e.bindKey(t.keys.DOWN_ARROW,"down");e.bindKey(t.keys.LEFT_ARROW,"left");e.bindKey(t.keys.RIGHT_ARROW,"right");e.bindKey(t.keys.BACKSPACE,"backspace");e.bindKey(t.keys.PLUS,"plus");e.bindKey(t.keys.MINUS,"minus");e.bindKey(t.keys.DIGITS[0],"0");e.bindKey(t.keys.DIGITS[9],"9");e.bindKey(t.keys.A,"a");e.bindKey(t.keys.X,"x");e.bindKey(t.keys.C,"c");e.bindKey(t.keys.V,"v")},keyDown:function(e,t,n,r){var i=types.interaction,s=selection.targets();switch(t){case"left":this.move("x",n?-5:-1);break;case"right":this.move("x",n?5:1);break;case"up":r?this.moveForward(s):this.move("y",n?-5:-1);break;case"down":r?this.moveBack(s):this.move("y",n?5:1);break;case"backspace":this.deleteItems();break;case"plus":r&&this.zoomIn();break;case"minus":r&&this.panOut();break;case"0":r&&this.fullScale();break;case"9":r&&this.fullPanOut();break;case"space":this.moveStage();case"a":console.log("select all");r&&this.selectAllItems();break;case"x":console.log("cutting");r&&this.cutItems();break;case"c":console.log("copying");r&&this.copyItems();break;case"v":console.log("pasting");r&&this.pasteItems()}},makeState:function(e,t,n){var r={type:e,initial:{}},i=r.initial;t?i.props=t:i.props={width:100,height:100,top:0,left:0};n?i.attr=n:i.attr={};switch(e){case"label":i.attr.text||(i.attr.text="Enter text in properties panel");i.props.color="#000000";break;case"container":i.props.fill={type:"solid",colors:[{rgb:"#999999"}]};case"image":i.props["border-color"]="#000000";break;case"button":default:}return r}}});$().fluxui.initialise({debug:!0});var colorPanel={keys:["color-panel"],hash:{"color-panel":{type:"controls.gradientpicker",initial:{props:{position:"relative",width:300,height:170}},children:{keys:["color-type-lbl","color-type","color-angle-lbl","color-angle","color-viewer","swatch-panel","swatch-panel-lbl"],hash:{"color-type-lbl":{type:"display.label",initial:{props:{left:10,top:10,width:40},attr:{text:"type:"}}},"color-type":{type:"display.form.dropdown",initial:{props:{left:45,top:10},attr:{labels:["solid","linear","radial"],values:["solid","linear","radial"]}}},"color-angle-lbl":{type:"display.label",initial:{props:{left:120,top:10,width:40},attr:{text:"angle:"}}},"color-angle":{type:"display.form.dropdown",initial:{props:{left:160,top:10},attr:{labels:["left","top left","top","top right","right","bottom right","bottom","bottom left"],values:[360,315,270,225,180,135,90,45]}}},"color-viewer":{type:"display.element",initial:{props:{left:10,top:40,width:270,height:40}}},"swatch-panel":{type:"display.element",initial:{props:{fill:{type:"linear",colors:[{rgb:"#9999dd",pos:0},{rgb:"#cccccc",pos:.4},{rgb:"#cccccc",pos:.6},{rgb:"#9999dd",pos:1}]},left:10,top:80,width:270,height:10}}},"swatch-panel-lbl":{type:"display.label",initial:{props:{left:10,top:100,width:270},attr:{text:"Double click on the blue bar to add a swatch to the gradient. Click again on the swatch to change the color, or drag it to change the arrangement of swatches along the length of the gradient."}}}}}}}},statePanel={keys:["state-panel"],hash:{"state-panel":{type:"controls.statePanel",initial:{props:{position:"relative",width:300,height:200}},children:{keys:["states-list","states-list-lbl","states-fld","states-fld-lbl","add-state-btn","remove-state-btn","up-state-btn","down-state-btn","state-duration","state-duration-lbl","state-easing","state-easing-lbl"],hash:{"states-list":{type:"display.form.dropdown",initial:{props:{left:10,top:30,width:200,height:70},attr:{size:4}}},"states-list-lbl":{type:"display.label",initial:{props:{top:10,left:10,width:60},attr:{text:"states"}}},"states-fld":{type:"display.form.textfield",initial:{props:{top:125,left:10,width:180}}},"states-fld-lbl":{type:"display.label",initial:{props:{top:105,left:10,width:60},attr:{text:"name"}}},"add-state-btn":{type:"display.button",initial:{props:{left:195,top:125,width:40,height:20,"border-width":1,"border-color":"#666666"}},children:{keys:["label"],hash:{label:{type:"display.label",initial:{props:{top:2,width:40,height:25,"text-align":"center"},attr:{text:"add"}},states:{}}}}},"remove-state-btn":{type:"display.button",initial:{props:{left:240,top:125,width:50,height:20,"border-width":1,"border-color":"#666666"}},children:{keys:["label"],hash:{label:{type:"display.label",initial:{props:{top:2,width:50,height:25,"text-align":"center"},attr:{text:"remove"}},states:{}}}}},"up-state-btn":{type:"display.button",initial:{props:{left:215,top:30,width:40,height:20,"border-width":1,"border-color":"#666666"}},children:{keys:["label"],hash:{label:{type:"display.label",initial:{props:{top:2,width:40,height:25,"text-align":"center"},attr:{text:"up"}},states:{}}}}},"down-state-btn":{type:"display.button",initial:{props:{left:215,top:80,width:40,height:20,"border-width":1,"border-color":"#666666"}},children:{keys:["label"],hash:{label:{type:"display.label",initial:{props:{top:2,width:40,height:25,"text-align":"center"},attr:{text:"down"}},states:{}}}}},"state-duration":{type:"display.form.textfield",initial:{props:{left:10,top:170,width:100}}},"state-duration-lbl":{type:"display.label",initial:{props:{left:10,top:150,width:100},attr:{text:"duration (ms)"}}},"state-easing":{type:"display.form.dropdown",initial:{props:{left:120,top:170,width:170},attr:{labels:["linear tween","ease in quad","ease out quad","ease in/out quad","ease in cubic","ease out cubic","ease in/out cubic","ease in quart","ease out quart","ease in out quart","ease in quint","ease out quint","ease in/out quint","ease in sine","ease out sine","ease in/out sine","ease in expo","ease out expo","ease in/out expo","ease in circ","ease out circ","ease in/out circ","ease in elastic","ease out elastic","ease in/out elastic","ease in back"
,"ease out back","ease in/out back","ease in bounce","ease out bounce","ease in/out bounce"],values:["linearTween","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","easeOutSine","easeInOutSine","easeInExpo","easeOutExpo","easeInOutExpo","easeInCirc","easeOutCirc","easeInOutCirc","easeInElastic","easeOutElastic","easeInOutElastic","easeInBack","easeOutBack","easeInOutBack","easeInBounce","easeOutBounce","easeInOutBounce"]}}},"state-easing-lbl":{type:"display.label",initial:{props:{left:120,top:150,width:60},attr:{text:"easing"}}}}}}}};alignmentPanel={keys:["align-panel"],hash:{"align-panel":{type:"display.element",initial:{props:{fill:{type:"linear",direction:"top",colors:[{rgb:"#d6d6d6",opacity:1,pos:0},{rgb:"#d6d6d6",opacity:1,pos:.423},{rgb:"#000000",opacity:1,pos:.425},{rgb:"#d6d6d6",opacity:1,pos:.427}]},position:"relative",width:300,height:275}},children:{keys:["realtime-label","box","type","top","right","bottom","left","align-label","align-left","align-center-x","align-right","align-top","align-center-y","align-bottom","distribute-label","distribute-left","distribute-center-x","distribute-right","distribute-top","distribute-center-y","distribute-bottom","match-label","match-width","match-height","match-both","space-label","space-x","space-y"],hash:{"realtime-label":{type:"display.label",initial:{props:{left:10,top:10},attr:{text:"Realtime:"}}},box:{type:"display.element",initial:{props:{top:40,left:15,width:120,height:60,"border-style":"solid","border-color":"#333333","border-width":1},attr:{text:"Realtime:"}}},type:{type:"display.form.dropdown",initial:{props:{top:60,left:30},attr:{labels:["none","anchoring","center x","center y","center both"],values:["none","anchor","horz","vert","both"]}},bind:{text:{event:"events.alignment.changed"}},behavior:{change:{event:"properties.alignment"}}},top:{type:"display.form.checkbox",initial:{props:{left:70,top:33}},bind:{text:{event:"events.anchor.top.changed"}},behavior:{change:{event:"properties.anchor.top"}}},right:{type:"display.form.checkbox",initial:{props:{left:130,top:63}},bind:{text:{event:"events.anchor.right.changed"}},behavior:{change:{event:"properties.anchor.right"}}},bottom:{type:"display.form.checkbox",initial:{props:{left:70,top:95}},bind:{text:{event:"events.anchor.bottom.changed"}},behavior:{change:{event:"properties.anchor.bottom"}}},left:{type:"display.form.checkbox",initial:{props:{left:8,top:63}},bind:{text:{event:"events.anchor.left.changed"}},behavior:{change:{event:"properties.anchor.left"}}},"align-label":{type:"display.label",initial:{props:{top:125,left:10},attr:{text:"Align:"}}},"align-left":{type:"display.button",initial:{props:{top:145,left:10,width:19,height:19}},behavior:{click:{event:"properties.align.left"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"align-left-img"}},states:{}}}}},"align-center-x":{type:"display.button",initial:{props:{top:145,left:40,width:19,height:19}},behavior:{click:{event:"properties.align.center.x"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"align-center-x-img"}},states:{}}}}},"align-right":{type:"display.button",initial:{props:{top:145,left:70,width:19,height:19}},behavior:{click:{event:"properties.align.right"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"align-right-img"}},states:{}}}}},"align-top":{type:"display.button",initial:{props:{top:145,left:120,width:19,height:19}},behavior:{click:{event:"properties.align.top"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"align-top-img"}},states:{}}}}},"align-center-y":{type:"display.button",initial:{props:{top:145,left:150,width:19,height:19}},behavior:{click:{event:"properties.align.center.y"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"align-center-y-img"}},states:{}}}}},"align-bottom":{type:"display.button",initial:{props:{top:145,left:180,width:19,height:19}},behavior:{click:{event:"properties.align.bottom"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"align-bottom-img"}},states:{}}}}},"distribute-label":{type:"display.label",initial:{props:{top:175,left:10},attr:{text:"Distribute:"}}},"distribute-left":{type:"display.button",initial:{props:{top:195,left:10,width:19,height:19}},behavior:{click:{event:"properties.distribute.left"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"distribute-left-img"}},states:{}}}}},"distribute-center-x":{type:"display.button",initial:{props:{top:195,left:40,width:19,height:19}},behavior:{click:{event:"properties.distribute.center.x"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"distribute-center-x-img"}},states:{}}}}},"distribute-right":{type:"display.button",initial:{props:{top:195,left:70,width:19,height:19}},behavior:{click:{event:"properties.distribute.right"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"distribute-right-img"}},states:{}}}}},"distribute-top":{type:"display.button",initial:{props:{top:195,left:120,width:19,height:19}},behavior:{click:{event:"properties.distribute.top"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"distribute-top-img"}},states:{}}}}},"distribute-center-y":{type:"display.button",initial:{props:{top:195,left:150,width:19,height:19}},behavior:{click:{event:"properties.distribute.center.y"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"distribute-center-y-img"}},states:{}}}}},"distribute-bottom":{type:"display.button",initial:{props:{top:195,left:180,width:19,height:19}},behavior:{click:{event:"properties.distribute.bottom"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"distribute-bottom-img"}},states:{}}}}},"match-label":{type:"display.label",initial:{props:{top:225,left:10},attr:{text:"Match size:"}}},"match-width":{type:"display.button",initial:{props:{top:245,left:10,width:19,height:19}},behavior:{click:{event:"properties.match.width"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"match-width-img"}},states:{}}}}},"match-height":{type:"display.button",initial:{props:{top:245,left:40,width:19,height:19}},behavior:{click:{event:"properties.match.height"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"match-height-img"}},states:{}}}}},"match-both":{type:"display.button",initial:{props:{top:245,left:70,width:19,height:19}},behavior:{click:{event:"properties.match.both"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"match-both-img"}},states:{}}}}},"space-label":{type:"display.label",initial:{props:{top:225,left:120},attr:{text:"Space:"}}},"space-x":{type:"display.button",initial:{props:{top:245,left:120,width:19,height:19}},behavior:{click:{event:"properties.space.x"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"space-x-img"}},states:{}}}}},"space-y":{type:"display.button",initial:{props:{top:245,left:150,width:19,height:19}},behavior:{click:{event:"properties.space.y"}},children:{keys:["img"],hash:{img:{type:"display.image",initial:{attr:{src:"space-y-img"}},states:{}}}}}}}}}};var libraryPanel={keys:["library-panel"],hash:{"library-panel":{type:"controls.library",initial:{props:{position:"relative",width:300,height:400}},children:{keys:["icon-bar","asset-viewer","asset-list-container"],hash:{"icon-bar":{type:"display.element",initial:{props:{fill:{type:"solid",colors:[{rgb:"#bbbbbb",opacity:1}]},width:300,height:26}},children:{keys:["add-asset"],hash:{"add-asset":{type:"display.image",initial:{props:{right:25,left:"",top:5,width:16,height:16,cursor:"pointer"},attr:{src:"btn-add-asset"}},behavior:{click:{event:"properties.library.add"}}}}}},"asset-viewer":{type:"display.element",initial:{props:{fill:{type:"solid",colors:[{rgb:"#ffffff",opacity:1}]},top:26,width:300,height:150}},children:{keys:["preview"],hash:{preview:{type:"display.image",initial:{props:{"max-width":300,"max-height":150},attr:{center:"both",src:"white-pixel"}}}}}},"asset-list-container":{type:"display.element",initial:{props:{top:180,width:280,height:220,overflow:"auto"}},children:{keys:["asset-list"],hash:{"asset-list":{type:"display.element",initial:{props:{width:255}},children:{keys:["sub-dirs","files"],hash:{"sub-dirs":{type:"display.container",initial:{props:{left:5,position:"relative"},attr:{"class":"sub-dirs"}},children:{keys:[],hash:{}}},files:{type:"display.container",initial:{props:{left:5,position:"relative"},attr:{"class":"files"}},children:{keys:[],hash:{}}}}}}}}}}},data:{keys:["asset-button","directory-button"],hash:{"asset-button":{type:"controls.libitem",initial:{props:{top:15,position:"relative",width:275,height:40},attr:{"class":"asset"}},behavior:{click:{event:"properties.library.item.click"}},children:{keys:["asset-label","asset-btn"],hash:{"asset-label":{type:"display.label",initial:{props:{bottom:4,"padding-top":5,"padding-bottom":5,"padding-left":5,height:36,"float":"left","min-width":70,position:"relative"},attr:{text:"this is the label"}}},"asset-btn":{type:"display.image",initial:{props:{"float":"left",position:"relative",left:15,top:5,width:16,height:16,cursor:"pointer"},attr:{src:"btn-remove-asset"}}}}}},"directory-button":{type:"controls.libdir",initial:{props:{position:"relative",width:275,"min-height":36}},behavior:{click:{event:"properties.library.dir.click"}},children:{keys:["dir-label","dir-btn","sub-dirs","files"],hash:{"dir-label":{type:"display.label",initial:{props:{position:"relative","padding-top":10,"padding-bottom":10,"padding-left":10,height:36},attr:{text:"this is the label"}}},"dir-btn":{type:"display.image",initial:{props:{left:420,width:16,height:16,cursor:"pointer"},attr:{src:"btn-remove-asset"}}},"sub-dirs":{type:"display.container",initial:{props:{left:15,position:"relative"},attr:{"class":"sub-dirs"}},children:{keys:[],hash:{}}},files:{type:"display.container",initial:{props:{left:25,position:"relative"},attr:{"class":"files"}},children:{keys:[],hash:{}}}}}}}}}}},componentPanel={keys:["component-panel"],hash:{"component-panel":{type:"controls.components",initial:{props:{position:"relative",width:300,height:450}},children:{keys:["component-viewer","component-list-container"],hash:{"component-viewer":{type:"display.element",initial:{props:{fill:{type:"solid",colors:[{rgb:"#ffffff",opacity:1}]},top:0,width:300,height:150}},children:{keys:["preview"],hash:{preview:{type:"display.image",initial:{props:{"max-width":300,"max-height":150},attr:{center:"both",src:"white-pixel"}}}}}},"component-list-container":{type:"display.element",initial:{props:{top:150,width:300,height:274,overflow:"auto"}},children:{keys:["component-list"],hash:{"component-list":{type:"display.element",initial:{props:{width:275}}}}}}}},data:{keys:["component-button"],hash:{"component-button":{type:"controls.componentitem",initial:{props:{position:"relative",width:275,height:26,cursor:"pointer"}},behavior:{click:{event:"properties.component.item.click"},dblclick:{event:"properties.component.item.dblclick"}},children:{keys:["component-label","component-icon"],hash:{"component-label":{type:"display.label",initial:{props:{top:5,left:45,width:200,height:16},attr:{text:"this is the label"}}},"component-icon":{type:"display.image",initial:{props:{top:5,left:5},attr:{src:"white-pixel"}}}}}}}}}}};explorerPanel={keys:["explorer-panel"],hash:{"explorer-panel":{type:"controls.explorer",initial:{props:{position:"relative",width:300,height:450}},children:{keys:["explorer-list"],hash:{"explorer-list":{type:"display.element",initial:{props:{top:5,width:300,height:449,overflow:"auto"}},children:{keys:["explorer-list"],hash:{"explorer-list":{type:"display.element",initial:{props:{width:275}}}}}}}},data:{keys:["explorer-button"],hash:{"explorer-button":{type:"controls.exploreritem",initial:{props:{position:"relative",width:275,height:26,cursor:"pointer"}},behavior:{click:{event:"properties.explorer.item.click"}},frames:{keys:["initial","_over","_selected"],hash:{initial:{},_over:{},_selected:{}}},children:{keys:["explorer-bg","explorer-label","explorer-icon"],hash:{"explorer-bg":{type:"display.element",initial:{props:{width:275,height:26,fill:{type:"solid",colors:[{rgb:"#d6d6d6"}]}}},states:{_over:{props:{fill:{type:"solid",colors:[{rgb:"#9999ff"}]}}},_selected:{props:{fill:{type:"solid",colors:[{rgb:"#9999ff"}]}}}}},"explorer-label":{type:"display.label",initial:{props:{top:5,left:10,width:200,height:16},attr:{text:"this is the label"}}},"explorer-icon":{type:"display.image",initial:{props:{top:5,right:5},attr:{src:"white-pixel"}}}}}}}}}}};var editor={assets:{"align-left-img":{url:"/assets/align-left.gif"},"align-center-x-img":{url:"/assets/align-center-x.gif"},"align-right-img":{url:"/assets/align-right.gif"},"align-top-img":{url:"/assets/align-top.gif"},"align-center-y-img":{url:"/assets/align-center-y.gif"},"align-bottom-img":{url:"/assets/align-bottom.gif"},"distribute-left-img":{url:"/assets/distribute-left.gif"},"distribute-center-x-img":{url:"/assets/distribute-center-x.gif"},"distribute-right-img":{url:"/assets/distribute-right.gif"},"distribute-top-img":{url:"/assets/distribute-top.gif"},"distribute-center-y-img":{url:"/assets/distribute-center-y.gif"},"distribute-bottom-img":{url:"/assets/distribute-bottom.gif"},"match-width-img":{url:"/assets/match-width.gif"},"match-height-img":{url:"/assets/match-height.gif"},"match-both-img":{url:"/assets/match-both.gif"},"space-x-img":{url:"/assets/space-x.gif"},"space-y-img":{url:"/assets/space-y.gif"},"accordion-btn":{url:"/assets/accordion-btn.gif"},"accordion-btn-selected":{url:"/assets/accordion-btn-selected.gif"},"accordion-right-arrow":{url:"/assets/accordion-right-arrow.gif"},"accordion-down-arrow":{url:"/assets/accordion-down-arrow.gif"},placeholder:{url:"/assets/spacer.gif"},"ico-properties":{url:"/assets/ico-properties.png"},"ico-palette":{url:"/assets/ico-palette.png"},"ico-align":{url:"/assets/ico-align.png"},"ico-library":{url:"/assets/ico-library.png"},"ico-components":{url:"/assets/ico-components.png"},"ico-state":{url:"/assets/ico-state.png"},"ico-explorer":{url:"/assets/ico-explorer.png"},logo:{url:"/assets/logo.gif"},"btn-div":{url:"/assets/btn-div.png"},"btn-img":{url:"/assets/btn-img.png"},"btn-lbl":{url:"/assets/btn-lbl.png"},"btn-btn":{url:"/assets/btn-btn.png"},"btn-add-asset":{url:"/assets/btn-add-asset.png"},"btn-remove-asset":{url:"/assets/btn-remove-asset.png"},"btn-reset-asset":{url:"/assets/btn-reset-asset.png"},"btn-placeholder-asset":{url:"/assets/btn-placeholder-asset.png"},"alpha-bg":{url:"/assets/alpha-bg.png"},"white-pixel":{url:"/assets/white-pixel.png"}},library:{},movie:{type:"display.element",initial:{props:{width:520,height:468,fill:{type:"solid",colors:[{rgb:"#000000",opacity:1}]}},attr:{anchor:[1,1,1,1]}},children:{keys:["header","left-sidebar","workspace","right-sidebar","request-dialog"],hash:{header:{type:"display.element",initial:{props:{fill:{type:"solid",colors:[{rgb:"#373737",opacity:1,pos:0}]},width:520,height:68},attr:{anchor:[1,1,0,1]}},children:{keys:["logo","breadcrumbs","menu"],hash:{logo:{type:"display.image",initial:{props:{left:20,top:17},attr:{src:"logo"}}},breadcrumbs:{type:"controls.breadcrumbs",initial:{props:{left:340,top:40,width:10,height:25},attr:{anchor:[0,1,0,1]}}},menu:{type:"controls.menu",initial:{props:{top:25,left:"",right:80,width:270,height:20}},children:{keys:["login-menu","app-menu"],hash:{"login-menu":{type:"display.element",initial:{props:{width:270,height:20}},children:{keys:["user-txt","pass-txt","login-btn","register"],hash:{"user-txt":{type:"display.form.textfield",initial:{props:{width:70},attr:{placeholder:"Username"}}},"pass-txt":{type:"display.form.textfield",initial:{props:{left:80,width:70},attr:{placeholder:"Password"}}},"login-btn":{type:"display.button",initial:{props:{left:160,width:40,height:18,"border-color":"#999999","border-width":1}},behavior:{click:{event:"menu.click.login"}},children:{keys:["login-label"],hash:{"login-label":{type:"display.label",initial:{props:{color:"#ffffff","font-size":12,"font-family":"arial","font-weight":"bold",left:4,width:40,height:18},attr:{text:"Login"}},states:{}}}}},register:{type:"display.button",initial:{props:{left:210,width:58,height:18,"border-color":"#999999","border-width":1}},behavior:{click:{event:"menu.click.register"}},children:{keys:["register-label"],hash:{"register-label":{type:"display.label",initial:{props:{color:"#ffffff","font-size":12,"font-family":"arial","font-weight":"bold",left:4,width:60,height:20},attr:{text:"Register"}},states:{}}}}}}}},"app-menu":{type:"display.element",initial:{props:{left:0,width:280,height:20,visibility:"hidden"}},children:{keys:["preview-btn","embed-btn","new-btn","open-btn","save-btn"],hash:{"preview-btn":{type:"display.button",initial:{props:{width:50,height:20}},behavior:{click:{event:"menu.click.preview"}},children:{keys:["preview-label"],hash:{"preview-label":{type:"display.label",initial:{props:{color:"#ffffff","font-size":12,"font-family":"arial","font-weight":"bold",width:50,height:20},attr:{text:"Preview"}},states:{}}}}},"embed-btn":{type:"display.button",initial:{props:{width:40,height:20,left:70}},behavior:{click:{event:"menu.click.embed"}},children:{keys:["embed-label"],hash:{"embed-label":{type:"display.label",initial:{props:{color:"#ffffff","font-size":12,"font-family":"arial","font-weight":"bold",width:42,height:20},attr:{text:"Embed"}},states:{}}}}},"new-btn":{type:"display.button",initial:{props:{width:40,height:20,left:130}},behavior:{click:{event:"menu.click.new"}},children:{keys:["new-label"],hash:{"new-label":{type:"display.label",initial:{props:{color:"#ffffff","font-size":12,"font-family":"arial","font-weight":"bold",width:40,height:20},attr:{text:"New"}},states:{}}}}},"open-btn":{type:"display.button",initial:{props:{width:40,height:20,left:180}},behavior:{click:{event:"menu.click.open"}},children:{keys:["open-label"],hash:{"open-label":{type:"display.label",initial:{props:{color:"#ffffff","font-size":12,"font-family":"arial","font-weight":"bold",width:40,height:20},attr:{text:"Open"}},states:{}}}}},"save-btn":{type:"display.button",initial:{props:{width:40,height:20,left:230}},behavior:{click:{event:"menu.click.save"}},children:{keys:["save-label"],hash:{"save-label":{type:"display.label",initial:{props:{color:"#ffffff","font-size":12,"font-family":"arial","font-weight":"bold",width:40,height:20},attr:{text:"Save"}},states:{}}}}}}}}}}}}}},"left-sidebar":{type:"display.element",initial:{props:{fill:{type:"solid",colors:[{rgb:"#373737",opacity:1}]},top:68,width:340,height:400},attr:{anchor:[1,0,1,1]}},children:{keys:["panels"],hash:{panels:{type:"controls.accordion",initial:{props:{fill:{type:"solid",colors:[{rgb:"#373737",opacity:1}]},width:300,height:400,left:20,"overflow-y":"auto"},attr:{anchor:[1,1,1,1]}},data:{keys:["button"],hash:{button:{type:"display.button",initial:{props:{width:300,height:36}},frames:{keys:["initial","_over","_selected"],hash:{initial:{},_over:{},_selected:{}}},children:{keys:["background","icon","label","state-icon"],hash:{background:{type:"display.image",initial:{props:{width:300,height:36},attr:{src:"accordion-btn"}},states:{_over:{attr:{src:"accordion-btn-selected"}},_selected:{attr:{src:"accordion-btn-selected"}}}},icon:{type:"display.image",initial:{props:{top:8,left:9},attr:{src:"placeholder"}},states:{initial:{},_over:{},_selected:{}}},label:{type:"display.label",initial:{props:{color:"#ffffff",top:9,left:40,"font-size":13},attr:{text:"Button"}},states:{initial:{},_over:{},_selected:{}}},"state-icon":{type:"display.image",initial:{props:{width:8,height:8,left:260,top:14},attr:{src:"accordion-right-arrow"}},states:{initial:{},_over:{},_selected:{attr:{src:"accordion-down-arrow"}}}}}}}}},children:{keys:["acc-property-panel","acc-color-panel","acc-state-panel","acc-align-panel","acc-library-panel","acc-component-panel","acc-explorer-panel"],hash:{"acc-property-panel":{type:"controls.accordionPanel",initial:{props:{position:"relative",width:300,fill:{type:"solid",colors:[{rgb:"#d6d6d6",opacity:1}]}},attr:{id:"propertiesPanel",text:"Properties",icon:"ico-properties"}},children:{keys:["propSheets"],hash:{propSheets:{type:"controls.properties",initial:{props:{position:"relative","max-width":300,"min-height":100}}}}}},"acc-color-panel":{type:"controls.accordionPanel",initial:{props:{width:300,fill:{type:"solid",colors:[{rgb:"#d6d6d6",opacity:1}]}},attr:{id:"colorPanel",text:"Background Gradient",icon:"ico-palette"}},children:colorPanel},"acc-state-panel":{type:"controls.accordionPanel",initial:{props:{width:300,fill:{type:"solid",colors:[{rgb:"#d6d6d6",opacity:1}]}},attr:{id:"statePanel",text:"States",icon:"ico-state"}},children:statePanel},"acc-align-panel":{type:"controls.accordionPanel",initial:{props:{width:300,fill:{type:"solid",colors:[{rgb:"#d6d6d6",opacity:1}]}},attr:{id:"alignPanel",text:"Alignment",icon:"ico-align"}},children:alignmentPanel},"acc-library-panel":{type:"controls.accordionPanel",initial:{props:{width:300,fill:{type:"solid",colors:[{rgb:"#d6d6d6",opacity:1}]}},attr:{id:"libraryPanel",text:"Library",icon:"ico-library"}},children:libraryPanel},"acc-component-panel":{type:"controls.accordionPanel",initial:{props:{width:300,fill:{type:"solid",colors:[{rgb:"#d6d6d6",opacity:1}]}},attr:{id:"componentPanel",text:"Components",icon:"ico-components"}},children:componentPanel},"acc-explorer-panel":{type:"controls.accordionPanel",initial:{props:{width:300,fill:{type:"solid",colors:[{rgb:"#d6d6d6",opacity:1}]}},attr:{id:"explorerPanel",text:"Item Explorer",icon:"ico-explorer"}},children:explorerPanel}}}}}}},workspace:{type:"display.element",initial:{props:{fill:{type:"solid",colors:[{rgb:"#666666",opacity:1}]},top:68,left:340,width:90,height:400,overflow:"auto"},attr:{anchor:[1,1,1,1]}},children:{keys:["stage-container"],hash:{"stage-container":{type:"display.element",initial:{props:{fill:{type:"solid",colors:[{rgb:"#666666",opacity:1}]},"min-height":5e3,"min-width":5e3}},children:{keys:["stage","view","hud"],hash:{stage:{type:"display.element",initial:{props:{fill:{type:"solid",colors:[{rgb:"#FFFFFF",opacity:1,pos:.1},{rgb:"#FFFFFF",opacity:1,pos:.9}]},width:400,height:300,overflow:"visible"},attr:{center:"both"}}},view:{type:"controls.view",initial:{props:{fill:{type:"solid",colors:[{rgb:"#FFFFFF",opacity:1,pos:.1},{rgb:"#FFFFFF",opacity:1,pos:.9}]},width:400,height:300,overflow:"visible",visibility:"hidden"},attr:{center:"both"}}},hud:{type:"display.element",initial:{props:{overflow:"visible",width:1,height:1}}}}}}}}},"right-sidebar":{type:"display.element",initial:{props:{fill:{type:"solid",colors:[{rgb:"#373737",opacity:1,pos:0}]},top:68,left:430,width:90,height:400},attr:{anchor:[1,1,1,0]}},children:{keys:["btn-div","btn-img","btn-lbl","btn-btn"],hash:{"btn-div":{type:"display.image",initial:{props:{top:4,left:16,cursor:"pointer"},attr:{src:"btn-div",title:"Add a plain element"}},behavior:{click:{event:"controls.add.div"}}},"btn-img":{type:"display.image",initial:{props:{top:4,left:50,cursor:"pointer"},attr:{src:"btn-img",title:"Add an image"}},behavior:{click:{event:"controls.add.img"}}},"btn-lbl":{type:"display.image",initial:{props:{top:30,left:16,cursor:"pointer"},attr:{src:"btn-lbl",title:"Add a label (textual content)"}},behavior:{click:{event:"controls.add.lbl"}}},"btn-btn":{type:"display.image",initial:{props:{top:30,left:50,cursor:"pointer"},attr:{src:"btn-btn",title:"Add a button (for switching between 'states')"}},behavior:{click:{event:"controls.add.btn"}}}}}},"request-dialog":{type:"controls.dialog",initial:{props:{position:"relative"}},children:{keys:["dialog-content","btn-submit"],hash:{"dialog-content":{type:"display.element",initial:{props:{position:"relative"}},children:{keys:["alert-message","import-asset","save-movie","open-movie","register-user","embed-movie"],hash:{"alert-message":{type:"display.element",initial:{props:{position:"relative",width:350,height:100}},children:{keys:["message-text"],hash:{"message-text":{type:"display.label",initial:{props:{"font-family":"arial",top:15,left:10}}}}}},"import-asset":{type:"display.element",initial:{props:{position:"relative"},attr:{text:"Import Asset"}},children:{keys:["import-desc","asset-lbl-label","asset-lbl-text","asset-url-label","asset-url-text","asset-file-label","asset-file-text","asset-progress"],hash:{"import-desc":{type:"display.label",initial:{props:{"font-family":"arial",top:15,left:10,height:60,width:390},attr:{text:"Please specify an asset to import. The label you supply will help differentiate the asset in the library, while the path should be an absolute path to the asset."}}},"asset-lbl-label":{type:"display.label",initial:{props:{"font-family":"arial",top:85,left:10,height:16,width:150},attr:{text:"Name:"}}},"asset-lbl-text":{type:"display.form.textfield",initial:{props:{top:85,left:60,width:300,"border-width":1,"border-color":"#bbbbbb"}}},"asset-url-label":{type:"display.label",initial:{props:{"font-family":"arial",top:135,left:10,height:16,width:150},attr:{text:"Path:"}}},"asset-url-text":{type:"display.form.textfield",initial:{props:{top:135,left:60,width:300,"border-width":1,"border-color":"#bbbbbb"}}},"asset-file-label":{type:"display.label",initial:{props:{"font-family":"arial",top:110,left:10,height:16,width:150},attr:{text:"Upload:"}}},"asset-file-text":{type:"display.form.file",initial:{props:{top:107,left:60,width:300,"border-width":1,"border-color":"#bbbbbb"},attr:{"data-url":"/upload","data-form-data":'{"script": "true"}',name:"files[]"}}},"asset-progress":{type:"display.element",initial:{props:{display:"none",left:10,top:170,width:350,height:16}},children:{keys:["asset-progress-label","asset-progress-bar"],hash:{"asset-progress-label":{type:"display.label",initial:{props:{"font-family":"arial",height:16,width:150},attr:{text:"Progress:"}}},"asset-progress-bar":{type:"display.element",initial:{props:{top:5,left:60,width:290,height:7,fill:{type:"solid",colors:[{rgb:"#000000"}]},"border-width":1,"border-color":"#bbbbbb"},attr:{"data-url":"/upload","data-form-data":'{"script": "true"}',name:"files[]"}},children:{keys:["duration"],hash:{duration:{type:"display.element",initial:{props:{width:0,height:5,fill:{type:"solid",colors:[{rgb:"#8ac820"}]}}}}}}}}}}}}},"save-movie":{type:"display.element",initial:{props:{position:"relative",height:154,width:300},attr:{text:"Save As..."}},children:{keys:["save-desc","file-name-label","file-name-text"],hash:{"save-desc":{type:"display.label",initial:{props:{"font-family":"arial",top:15,left:10,height:50,width:290},attr:{text:"Please provide a unique name for your movie. (Note: Providing an existing name will overwrite that project)."}}},"file-name-label":{type:"display.label",initial:{props:{"font-family":"arial",top:75,left:10,height:16,width:150},attr:{text:"File name:"}}},"file-name-text":{type:"display.form.textfield",initial:{props:{top:96,left:10,width:280,"border-width":1,"border-color":"#bbbbbb"}}}}}},"open-movie":{type:"display.element",initial:{props:{position:"relative",height:124,width:300},attr:{text:"Open Movie"}},children:{keys:["open-desc","file-open-label","file-open-list"],hash:{"open-desc":{type:"display.label",initial:{props:{"font-family":"arial",top:15,left:10,height:50,width:290},attr:{text:"Please select a file to open."}}},"file-open-label":{type:"display.label",initial:{props:{"font-family":"arial",top:45,left:10,height:16,width:150},attr:{text:"File name:"}}},"file-open-list":{type:"display.form.dropdown",initial:{props:{top:66,left:10,"border-width":1,"border-color":"#bbbbbb"}}}}}},"register-user":{type:"display.element",initial:{props:{position:"relative",height:124,width:300},attr:{text:"Register"}},children:{keys:["register-desc","register-user-lbl","register-user-txt","register-pass-lbl","register-pass-txt","register-email-lbl","register-email-txt"],hash:{"register-desc":{type:"display.label",initial:{props:{"font-family":"arial",top:15,left:10,height:50,width:290},attr:{text:"Provide a username and password."}}},"register-user-lbl":{type:"display.label",initial:{props:{"font-family":"arial",top:45,left:10,height:18,width:35},attr:{text:"user:"}}},"register-user-txt":{type:"display.form.textfield",initial:{props:{top:45,left:45,height:18,width:100,"border-width":1,"border-color":"#bbbbbb"}}},"register-pass-lbl":{type:"display.label",initial:{props:{"font-family":"arial",top:45,left:155,height:18,width:35},attr:{text:"pass:"}}},"register-pass-txt":{type:"display.form.textfield",initial:{props:{top:45,left:190,height:18,width:100,"border-width":1,"border-color":"#bbbbbb"}}},"register-email-lbl":{type:"display.label",initial:{props:{"font-family":"arial",top:70,left:10,height:18,width:35},attr:{text:"email:"}}},"register-email-txt":{type:"display.form.textfield",initial:{props:{top:70,left:45,height:18,width:245,"border-width":1,"border-color":"#bbbbbb"}}}}}},"embed-movie":{type:"display.element",initial:{props:{position:"relative",height:150,width:450},attr:{text:"Embed Tag"}},children:{keys:["embed-desc","embed-text"],hash:{"embed-desc":{type:"display.label",initial:{props:{"font-family":"arial",top:15,left:10,height:50,width:440},attr:{text:"Copy and paste the code below into your web pages HTML."}}},"embed-text":{type:"display.form.textarea",initial:{props:{top:50,left:10,width:435,height:70,"border-width":1,"border-color":"#bbbbbb"}}}}}}}}},"btn-submit":{type:"display.button",initial:{props:{fill:{type:"linear",direction:0,colors:[{rgb:"#8bc920",pos:.1,opacity:1},{rgb:"#4b7715",pos:.9,opacity:1}]},right:10,left:"",top:"",bottom:10,width:70,height:32,"border-radius":5}},behavior:{click:{event:"dialog.submit"}},children:{keys:["import-submit-label"],hash:{"import-submit-label":{type:"display.label",initial:{props:{top:8,width:70,"text-align":"center","font-weight":"bold","font-family":"arial"},attr:{text:"Ok"}},states:{}}}}}}}}}}}};$.fn.fluxui.evt().addListener("app.loaded",function(){$("#movie-container").fluxui(editor,function(e){new e.types.editor(e.inst)})})});